<!doctype html>
<html lang="vi">
<head>
<meta charset="utf-8">
<title>TV YouTube VÃ´ Háº¡n</title>
<meta name="viewport" content="width=device-width,initial-scale=1">
<style>
  body{margin:0;font-family:sans-serif;background:#000;color:#eee;display:flex;flex-direction:column;align-items:center;justify-content:center;height:100vh}
  #player{width:90vw;height:60vh;background:#111;margin-bottom:10px}
  button{background:#222;color:#eee;border:0;padding:10px 18px;border-radius:8px;cursor:pointer;margin:0 5px}
  button:hover{background:#333}
  #status{font-size:14px;color:#aaa;margin-top:8px}
</style>
</head>
<body>
  <div id="player"></div>
  <div>
    <button id="nextBtn">â­ï¸ KÃªnh má»›i</button>
    <button id="toggleAuto">ğŸ” Tá»± Ä‘á»™ng: Báº¬T</button>
  </div>
  <div id="status">Äang táº£i video Ä‘áº§u tiÃªn...</div>

<script>
const API_KEY = "AIzaSyDwN50y0-_Huo2hfpQCnFIqlDrOPSvi3Eo";

// Máº£ng tá»« khÃ³a Ä‘á»ƒ random tÃ¬m video
const KEYWORDS = [
  "music", "news", "movie", "funny", "animals", "sports",
  "live", "technology", "travel", "kpop", "documentary",
  "food", "vlog", "game", "space", "robot", "nature", "meme"
];

let player, autoPlay = true, viewed = 0;

function randomKeyword() {
  return KEYWORDS[Math.floor(Math.random() * KEYWORDS.length)];
}

// Gá»i YouTube Data API Ä‘á»ƒ láº¥y video ngáº«u nhiÃªn
async function getRandomVideoId() {
  const q = randomKeyword();
  const url = `https://www.googleapis.com/youtube/v3/search?part=snippet&type=video&videoEmbeddable=true&maxResults=10&order=viewCount&q=${encodeURIComponent(q)}&key=${API_KEY}`;
  try {
    const res = await fetch(url);
    const data = await res.json();
    if (!data.items || data.items.length === 0) throw new Error("KhÃ´ng tÃ¬m tháº¥y video");
    const v = data.items[Math.floor(Math.random() * data.items.length)];
    return v.id.videoId;
  } catch (err) {
    console.error("Lá»—i táº£i video:", err);
    return null;
  }
}

async function loadRandomVideo() {
  const vid = await getRandomVideoId();
  if (!vid) {
    document.getElementById("status").textContent = "KhÃ´ng táº£i Ä‘Æ°á»£c video. Thá»­ láº¡i...";
    setTimeout(loadRandomVideo, 2000);
    return;
  }
  viewed++;
  document.getElementById("status").textContent = `Äang xem video ${viewed} | ID: ${vid}`;
  if (player && player.loadVideoById) {
    player.loadVideoById(vid);
  } else {
    player = new YT.Player("player", {
      videoId: vid,
      playerVars: {autoplay:1,controls:1,rel:0,modestbranding:1},
      events: {
        onStateChange: (ev) => {
          if (ev.data === YT.PlayerState.ENDED && autoPlay) {
            setTimeout(loadRandomVideo, 1000);
          }
        },
        onError: () => {
          setTimeout(loadRandomVideo, 1000);
        }
      }
    });
  }
}

// NÃºt báº¥m
document.getElementById("nextBtn").onclick = loadRandomVideo;
document.getElementById("toggleAuto").onclick = () => {
  autoPlay = !autoPlay;
  document.getElementById("toggleAuto").textContent = `ğŸ” Tá»± Ä‘á»™ng: ${autoPlay ? "Báº¬T" : "Táº®T"}`;
};

// Gá»i API script YouTube
(function(){
  const tag = document.createElement("script");
  tag.src = "https://www.youtube.com/iframe_api";
  const first = document.getElementsByTagName("script")[0];
  first.parentNode.insertBefore(tag, first);
})();
function onYouTubeIframeAPIReady(){
  loadRandomVideo();
}
</script>
</body>
</html>
