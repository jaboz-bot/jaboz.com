<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>B·∫£ng Ch·∫•m C√¥ng C√° Nh√¢n</title>
<style>
/* CSS C∆† B·∫¢N V√Ä CHUNG */
html,body{height:100%;margin:0;font-family:Arial,sans-serif;background:#f6f8f9}
.container{max-width:900px;margin:20px auto;background:#fff;padding:20px;border-radius:10px;box-shadow:0 4px 10px rgba(0,0,0,.1)}

/* CSS M·ªöI: ƒê·ªãnh d·∫°ng khu v·ª±c n√∫t v√† danh s√°ch c√¥ng vi·ªác */
.job-management {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding-bottom: 10px;
    margin-bottom: 5px; 
    border-bottom: 1px solid #ddd;
}
.add-job-btn {
    padding: 8px 15px;
    background: #2ecc71;
    color: #fff;
    border: none;
    border-radius: 5px;
    cursor: pointer;
    font-weight: bold;
    box-shadow: 0 2px 5px rgba(0,0,0,.1);
    white-space: nowrap; 
}

/* CSS CHO CAROUSEL */
#jobCarousel {
    display: flex; 
    overflow-x: auto; 
    scroll-snap-type: x mandatory; 
    scroll-behavior: smooth; 
    -webkit-overflow-scrolling: touch; 
    margin-bottom: 15px;
    border: 1px solid #e0e0e0;
    border-radius: 8px;
    padding: 10px;
    background: #f7f7f7;
    box-shadow: inset 0 0 5px rgba(0,0,0,.05);
}
.job-item {
    min-width: 100%; 
    flex-shrink: 0; 
    padding: 5px;
    font-size: 0.9em;
    color: #333;
    cursor: pointer;
    scroll-snap-align: start; 
    box-sizing: border-box;
}
.job-item.selected {
    background-color: #d7e8f5; 
    border: 1px solid #2980b9;
    border-radius: 5px;
}
.job-item strong { 
    color: #2980b9; 
    display: block;
    font-size: 1.1em;
}
.job-item span { 
    color: #7f8c8d; 
    display: block;
    margin-top: 3px;
    font-size: 0.85em;
}
.job-item:hover { 
    background-color: #eaf2f8; 
}


/* CSS C≈© (ti·∫øp t·ª•c) */
.header{display:flex;justify-content:space-between;align-items:center;border-bottom:2px solid #3498db;padding-bottom:10px}
.month-nav{display:flex;align-items:center;gap:8px;font-weight:bold;color:#27ae60}
.arrow{cursor:pointer;user-select:none;font-size:1.3em}
table{width:100%;border-collapse:collapse;margin-top:10px}
th,td{border:1px solid #ccc;text-align:center;padding:5px;font-size:.85em}
/* C·ªôt ti√™u ƒë·ªÅ m·∫∑c ƒë·ªãnh */
th{background:#eaf2f8}
.day{position:relative;height:80px;vertical-align:top;cursor:pointer}
.day span{position:absolute;top:3px;left:5px;font-weight:bold;color:#2980b9}
.day div{position:absolute;bottom:3px;left:0;width:100%;font-size:.8em;color:#27ae60}
.summary{margin-top:20px;background:#ecf9ff;padding:10px;border-radius:5px}

/* CSS CHO MODAL CHUNG */
.modal{display:none;position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,.6);justify-content:center;align-items:center;z-index:1000;}
.modal-content{background:#fff;padding:20px;border-radius:10px;width:90%;max-width:400px}
.modal-content input[type="text"], .modal-content input[type="date"], .modal-content select{width:100%;padding:8px;margin:5px 0;border:1px solid #ccc;border-radius:5px;box-sizing:border-box;}

/* ƒêi·ªÅu ch·ªânh cho 3 n√∫t: X√≥a n·∫±m b√™n tr√°i, H·ªßy v√† L∆∞u n·∫±m b√™n ph·∫£i */
.button-group{
    display: flex;
    justify-content: space-between;
    align-items: center;
}
.modal-content button{margin-top:15px;padding:8px 12px;border:none;border-radius:5px;cursor:pointer}
.save{background:#3498db;color:#fff}
.cancel{background:#ccc}
.delete{background:#e74c3c;color:#fff} 


/* Modal N∆°i l√†m vi·ªác m·ªõi */
#jobModal .input-group { margin-bottom: 15px; }
#jobModal .input-group label { display: block; margin-bottom: 5px; font-weight: bold; color: #34495e; }
#jobModal .input-group input[type="checkbox"] { margin-right: 5px; }
.job-button-group { display: flex; justify-content: space-between; align-items: center; }
.job-button-group .right-buttons button { margin-left: 10px; }

/* *** PH·∫¶N S·ª¨A L·ªñI C√ÇN ƒê·ªêI V√Ä L√ÄM ƒê·∫∏P GIAO DI·ªÜN NH·∫¨P GI·ªú *** */
.time-input-group { display: flex; align-items: center; margin-bottom: 10px; }
.time-input-group label { font-weight: bold; width: 40px; text-align: left; margin-right: 10px; }

/* C·∫¨P NH·∫¨T CSS: √Åp d·ª•ng style c√¢n b·∫±ng cho c·∫£ input type=time V√Ä select */
.time-input-group input[type="time"], 
.time-input-group select { 
    flex-grow: 1; 
    padding: 8px;
    border: 1px solid #ccc;
    border-radius: 5px;
    box-sizing: border-box;
    width: auto; 
}


/* --- T√πy ch·ªânh Calendar v√† Input L∆∞∆°ng/gi·ªù --- */
table th:first-child { background: #e74c3c; color: #fff; }
table tr td:first-child { background-color: #fcecec; }
table tr td:first-child span { color: #c0392b !important; }
table tr td:empty { background-color: #dddddd; cursor: default; }
.header input#rate { min-width: 70px; width: 70px; transition: width 0.2s ease-in-out; text-align: right; }

</style>
</head>
<body>
<div class="container">
    <div class="job-management">
        <button class="add-job-btn" id="openJobModal">‚ûï Qu·∫£n l√Ω N∆°i l√†m vi·ªác</button>
    </div>
    
    <div id="jobCarousel">
        </div>
    <div class="header">
        <div class="month-nav">
            <span class="arrow" id="prevMonth">‚óÄ</span>
            <span id="monthYear"></span>
            <span class="arrow" id="nextMonth">‚ñ∂</span>
        </div>
        <div>
            üí∞ L∆∞∆°ng/gi·ªù: <input type="number" id="rate" value="100000"> VND
        </div>
    </div>
    
    <table>
        <thead>
            <tr><th>CN</th><th>T2</th><th>T3</th><th>T4</th><th>T5</th><th>T6</th><th>T7</th></tr>
        </thead>
        <tbody id="calendar"></tbody>
    </table>

    <div class="summary">
        ‚úÖ T·ªïng gi·ªù c√¥ng vi·ªác hi·ªán t·∫°i: <span id="totalHours">0</span> gi·ªù<br>
        üíµ Thu nh·∫≠p ∆∞·ªõc t√≠nh: <span id="totalPay">0</span> VND
    </div>
</div>

<div class="modal" id="timeModal">
    <div class="modal-content">
        <h3>Nh·∫≠p gi·ªù c√¥ng - <span id="modalDate"></span></h3>
        
        <div class="time-input-group">
            <label for="jobSelect">N∆°i:</label>
            <select id="jobSelect"></select>
        </div>
        
        <div class="time-input-group">
            <label for="timeIn">V√†o:</label>
            <input type="time" id="timeIn" value="09:00">
        </div>
        
        <div class="time-input-group">
            <label for="timeOut">Ra:</label>
            <input type="time" id="timeOut" value="18:00">
        </div>
        
        <div class="button-group">
            <button class="delete" id="deleteTime">X√≥a</button>
            <div>
                <button class="cancel" id="cancelTime">H·ªßy</button>
                <button class="save" id="saveTime">L∆∞u</button>
            </div>
        </div>
    </div>
</div>

<div class="modal" id="jobModal">
    <div class="modal-content">
        <h3 id="jobModalTitle">Th√™m N∆°i l√†m vi·ªác m·ªõi</h3>
        
        <div class="input-group">
            <label for="jobName">T√™n N∆°i l√†m vi·ªác:</label>
            <input type="text" id="jobName" placeholder="T√™n c√¥ng ty/D·ª± √°n..." required>
        </div>

        <div class="input-group">
            <label for="jobAddress">ƒê·ªãa ch·ªâ:</label>
            <input type="text" id="jobAddress" placeholder="ƒê·ªãa ch·ªâ n∆°i l√†m vi·ªác (VD: 123 ƒë∆∞·ªùng ABC)">
        </div>

        <div class="input-group">
            <label for="jobStartDate">Ng√†y B·∫Øt ƒë·∫ßu:</label>
            <input type="date" id="jobStartDate" required>
        </div>

        <div class="input-group">
            <label for="jobEndDate">Ng√†y K·∫øt th√∫c:</label>
            <input type="date" id="jobEndDate">
            <input type="checkbox" id="jobIsCurrent"> ƒêang l√†m
        </div>
        
        <div class="job-button-group">
            <button class="delete" id="deleteJob">X√≥a</button>
            <div class="right-buttons">
                <button class="cancel" id="cancelJob">H·ªßy</button>
                <button class="save" id="saveJob">L∆∞u</button>
            </div>
        </div>
    </div>
</div>

<script>
// --- KHAI B√ÅO BI·∫æN ---
let currentMonth = new Date().getMonth();
let currentYear = new Date().getFullYear();
let workData = JSON.parse(localStorage.getItem('workData') || '{}'); 
let appSettings = JSON.parse(localStorage.getItem('appSettings') || '{}'); 
let jobs = JSON.parse(localStorage.getItem('jobs') || '[]'); 
let editingJobId = null; 

const rateInput = document.getElementById('rate');
const jobModal = document.getElementById('jobModal');
const jobCarouselDiv = document.getElementById('jobCarousel'); 
const jobSelect = document.getElementById('jobSelect'); 


// --- H√ÄM CHUNG & QU·∫¢N L√ù C√îNG VI·ªÜC ---
function daysInMonth(y,m){return new Date(y,m+1,0).getDate();}

function saveJobs() {
    localStorage.setItem('jobs', JSON.stringify(jobs));
    renderJobList();
    renderJobSelectOptions(); 
}

// L·∫•y ID c√¥ng vi·ªác ƒëang ƒë∆∞·ª£c ch·ªçn (ƒëang n·∫±m ·ªü v·ªã tr√≠ cu·ªôn ngang ƒë·∫ßu ti√™n)
function getCurrentJobId() {
    if (jobs.length === 0) return null;
    
    const scrollPos = jobCarouselDiv.scrollLeft;
    const itemWidth = jobCarouselDiv.offsetWidth; 
    
    const selectedIndex = Math.round(scrollPos / itemWidth);
    
    const items = jobCarouselDiv.querySelectorAll('.job-item');
    items.forEach((item, index) => {
        item.classList.toggle('selected', index === selectedIndex);
    });
    
    return jobs[selectedIndex] ? jobs[selectedIndex].id : null;
}

// X·ª≠ l√Ω s·ª± ki·ªán cu·ªôn
jobCarouselDiv.addEventListener('scroll', () => {
    clearTimeout(jobCarouselDiv.scrollTimeout);
    jobCarouselDiv.scrollTimeout = setTimeout(() => {
        renderCalendar(); 
    }, 100); 
});


function renderJobList() {
    jobCarouselDiv.innerHTML = '';
    
    if (jobs.length === 0) {
        jobCarouselDiv.innerHTML = '<div style="color:#999;font-size:0.9em; min-width: 100%; text-align: center; padding: 15px;">Ch∆∞a c√≥ n∆°i l√†m vi·ªác n√†o ƒë∆∞·ª£c th√™m.</div>';
        jobCarouselDiv.style.border = '1px dashed #ccc'; 
        jobCarouselDiv.style.boxShadow = 'none';
        jobCarouselDiv.style.background = 'none';
        return;
    }
    
    jobCarouselDiv.style.border = '1px solid #e0e0e0';
    jobCarouselDiv.style.boxShadow = 'inset 0 0 5px rgba(0,0,0,.05)';
    jobCarouselDiv.style.background = '#f7f7f7';

    jobs.forEach(job => {
        const item = document.createElement('div');
        item.className = 'job-item';
        item.dataset.id = job.id;

        let dateStr = job.isCurrent ? 
            `T·ª´ ${formatDate(job.startDate)} - ƒêang l√†m` : 
            `T·ª´ ${formatDate(job.startDate)} ƒë·∫øn ${formatDate(job.endDate)}`;
        
        const addressHtml = job.address ? `<span>üìç ${job.address}</span>` : '';

        item.innerHTML = `
            <strong>${job.name}</strong> 
            <span>${dateStr}</span>
            ${addressHtml}
        `;
        item.onclick = () => openJobModalForEdit(job.id);
        jobCarouselDiv.appendChild(item);
    });
    
    getCurrentJobId(); 
}

function formatDate(dateString) {
    if (!dateString) return '';
    const parts = dateString.split('-');
    return `${parts[2]}/${parts[1]}/${parts[0]}`;
}


// --- LOGIC MODAL NH·∫¨P GI·ªú & L·ªäCH ---

function renderJobSelectOptions() {
    jobSelect.innerHTML = '';
    if (jobs.length === 0) {
        jobSelect.innerHTML = '<option value="">(Ch∆∞a c√≥ c√¥ng vi·ªác)</option>';
        return;
    }
    jobs.forEach(job => {
        const option = document.createElement('option');
        option.value = job.id;
        option.textContent = job.name;
        jobSelect.appendChild(option);
    });
}

function updateSummary(){
    const rate = appSettings.rate || parseFloat(rateInput.value) || 0; 
    let totalH = 0;
    const currentJobId = getCurrentJobId(); 
    
    for(const k in workData) {
        if (workData[k] && workData[k][currentJobId]) {
            totalH += workData[k][currentJobId].hours || 0;
        }
    }
    
    document.getElementById('totalHours').textContent=totalH.toFixed(2);
    document.getElementById('totalPay').textContent=(totalH*rate).toLocaleString('vi-VN');
    localStorage.setItem('workData',JSON.stringify(workData));
}

function renderCalendar(){
    const tbl=document.getElementById('calendar');
    tbl.innerHTML='';
    const firstDay=new Date(currentYear,currentMonth,1).getDay();
    const totalDays=daysInMonth(currentYear,currentMonth);
    document.getElementById('monthYear').textContent=`${currentMonth+1}/${currentYear}`;
    let day=1; 

    const currentJobId = getCurrentJobId(); 

    for(let r=0;r<6;r++){
        const tr=document.createElement('tr');
        for(let c=0;c<7;c++){
            const td=document.createElement('td');
            if(r===0&&c<firstDay||day>totalDays){
                td.innerHTML='';
            } else {
                const dkey=`${currentYear}-${currentMonth+1}-${day}`;
                const dayData = workData[dkey] || {};
                const info = dayData[currentJobId] || {}; 

                td.className='day'; 
                td.innerHTML=`<span>${day}</span>${info.hours?`<div>${info.hours.toFixed(2)}h</div>`:''}`;
                td.onclick=()=>openModal(dkey);
                day++;
            }
            tr.appendChild(td);
        } 
        tbl.appendChild(tr);
        if(day>totalDays)break;
    }
    updateSummary();
}

// Modal Nh·∫≠p Gi·ªù
function openModal(key){
    const m=document.getElementById('timeModal');
    m.style.display='flex';
    const dateParts=key.split('-');
    document.getElementById('modalDate').textContent=`${dateParts[2]}/${dateParts[1]}`;
    m.dataset.key=key;
    
    const dayData = workData[key] || {};
    const defaultJobId = getCurrentJobId();
    let info = dayData[defaultJobId] || {};

    // 1. C·∫≠p nh·∫≠t dropdown
    renderJobSelectOptions();
    if (defaultJobId) {
        jobSelect.value = defaultJobId;
    }
    
    // N·∫øu dropdown kh√¥ng c√≥ gi√° tr·ªã m·∫∑c ƒë·ªãnh, th·ª≠ l·∫•y job ƒë·∫ßu ti√™n trong ng√†y
    if (!defaultJobId && Object.keys(dayData).length > 0) {
        const firstJobId = Object.keys(dayData)[0];
        jobSelect.value = firstJobId;
        info = dayData[firstJobId];
    }
    

    // 2. C·∫≠p nh·∫≠t gi·ªù v√†o/ra
    document.getElementById('timeIn').value=info.in||'09:00';
    document.getElementById('timeOut').value=info.out||'18:00';
    document.getElementById('deleteTime').style.display = info.hours ? 'inline-block' : 'none';

    // S·ª± ki·ªán thay ƒë·ªïi dropdown ƒë·ªÉ load gi·ªù t∆∞∆°ng ·ª©ng
    jobSelect.onchange = () => {
        const selectedJobId = jobSelect.value;
        const selectedInfo = dayData[selectedJobId] || {};
        document.getElementById('timeIn').value=selectedInfo.in||'09:00';
        document.getElementById('timeOut').value=selectedInfo.out||'18:00';
        document.getElementById('deleteTime').style.display = selectedInfo.hours ? 'inline-block' : 'none';
    };
}

document.getElementById('saveTime').onclick=()=>{
    const key=document.getElementById('timeModal').dataset.key;
    const selectedJobId = jobSelect.value; 
    
    if (!selectedJobId) {
        alert("Vui l√≤ng th√™m N∆°i l√†m vi·ªác tr∆∞·ªõc khi ch·∫•m c√¥ng.");
        return;
    }

    const tin=document.getElementById('timeIn').value;
    const tout=document.getElementById('timeOut').value;
    const [hi,mi]=tin.split(':').map(Number);const [ho,mo]=tout.split(':').map(Number);
    let hrs=(ho+mo/60)-(hi+mi/60);
    if(hrs < 0) { hrs += 24; }
    
    if (!workData[key]) {
        workData[key] = {};
    }

    workData[key][selectedJobId] = { in:tin, out:tout, hours:hrs };

    document.getElementById('timeModal').style.display='none';
    renderCalendar();
};

document.getElementById('deleteTime').onclick=()=>{
    const key=document.getElementById('timeModal').dataset.key;
    const selectedJobId = jobSelect.value;
    
    if(confirm(`B·∫°n c√≥ ch·∫Øc ch·∫Øn mu·ªën x√≥a gi·ªù c√¥ng c·ªßa ng√†y n√†y cho ${jobSelect.options[jobSelect.selectedIndex].text} kh√¥ng?`)) {
        if (workData[key] && workData[key][selectedJobId]) {
            delete workData[key][selectedJobId];
            
            if (Object.keys(workData[key]).length === 0) {
                delete workData[key];
            }
        }
        document.getElementById('timeModal').style.display='none';
        renderCalendar();
    }
};


// --- C√ÅC H√ÄM KH·ªûI T·∫†O V√Ä S·ª∞ KI·ªÜN KH√ÅC (Gi·ªØ nguy√™n) ---

document.getElementById('cancelTime').onclick=()=>document.getElementById('timeModal').style.display='none';

function updateSettings() {
    appSettings.rate = parseFloat(rateInput.value) || 0;
    localStorage.setItem('appSettings', JSON.stringify(appSettings));
    updateSummary(); 
}

function adjustRateInputWidth() {
    const val = String(rateInput.value).replace(/[^0-9]/g, '');
    const length = val.length;
    let newWidth = 70; 
    const pixelPerChar = 10; 
    if (length >= 4) { newWidth = 70 + (length - 4) * pixelPerChar; }
    if (length > 12) { newWidth = 70 + (12 - 4) * pixelPerChar; }
    rateInput.style.width = `${newWidth}px`;
}

document.getElementById('prevMonth').onclick=()=>{currentMonth--;if(currentMonth<0){currentMonth=11;currentYear--;}renderCalendar();};
document.getElementById('nextMonth').onclick=()=>{currentMonth++;if(currentMonth>11){currentMonth=0;currentYear++;}renderCalendar();};

rateInput.oninput = adjustRateInputWidth; 
rateInput.onchange = updateSettings; 

document.getElementById('openJobModal').onclick = () => openJobModal();

// --- LOGIC QU·∫¢N L√ù C√îNG VI·ªÜC (GI·ªÆ NGUY√äN) ---
function openJobModalForEdit(id) {
    openJobModal(id);
}
// H√ÄM M·ªöI: M·ªü Modal nh·∫≠p/s·ª≠a c√¥ng vi·ªác
function openJobModal(id = null) {
    editingJobId = id;
    const nameInput = document.getElementById('jobName');
    const addressInput = document.getElementById('jobAddress');
    const startInput = document.getElementById('jobStartDate');
    const endInput = document.getElementById('jobEndDate');
    const currentCheckbox = document.getElementById('jobIsCurrent');
    const title = document.getElementById('jobModalTitle');
    const deleteBtn = document.getElementById('deleteJob');

    if (id !== null) {
        const job = jobs.find(j => j.id === id);
        if (!job) return;
        
        title.textContent = 'S·ª≠a N∆°i l√†m vi·ªác';
        nameInput.value = job.name;
        addressInput.value = job.address || '';
        startInput.value = job.startDate;
        endInput.value = job.endDate || '';
        currentCheckbox.checked = job.isCurrent;
        deleteBtn.style.display = 'inline-block';
    } else {
        title.textContent = 'Th√™m N∆°i l√†m vi·ªác m·ªõi';
        nameInput.value = '';
        addressInput.value = '';
        startInput.value = new Date().toISOString().split('T')[0];
        endInput.value = '';
        currentCheckbox.checked = true;
        deleteBtn.style.display = 'none';
    }
    
    toggleEndDateInput(currentCheckbox.checked);
    jobModal.style.display = 'flex';
}

// H√ÄM M·ªöI: X·ª≠ l√Ω logic ƒêang l√†m / Ng√†y K·∫øt th√∫c
function toggleEndDateInput(isCurrent) {
    const endInput = document.getElementById('jobEndDate');
    endInput.disabled = isCurrent;
    endInput.style.backgroundColor = isCurrent ? '#eee' : '#fff';
    endInput.required = !isCurrent;
}
document.getElementById('jobIsCurrent').onchange = (e) => toggleEndDateInput(e.target.checked);


// H√ÄM M·ªöI: L∆∞u c√¥ng vi·ªác
document.getElementById('saveJob').onclick = () => {
    const name = document.getElementById('jobName').value.trim();
    const address = document.getElementById('jobAddress').value.trim();
    const startDate = document.getElementById('jobStartDate').value;
    const isCurrent = document.getElementById('jobIsCurrent').checked;
    let endDate = isCurrent ? null : document.getElementById('jobEndDate').value;

    if (!name || !startDate) {
        alert('Vui l√≤ng nh·∫≠p T√™n N∆°i l√†m vi·ªác v√† Ng√†y B·∫Øt ƒë·∫ßu.');
        return;
    }
    if (!isCurrent && !endDate) {
        alert('Vui l√≤ng nh·∫≠p Ng√†y K·∫øt th√∫c ho·∫∑c ch·ªçn "ƒêang l√†m".');
        return;
    }

    const jobObject = { 
        name, 
        address, 
        startDate, 
        endDate, 
        isCurrent 
    };

    if (editingJobId) {
        const index = jobs.findIndex(j => j.id === editingJobId);
        if (index !== -1) {
            jobs[index] = { id: editingJobId, ...jobObject };
        }
    } else {
        const newId = Date.now();
        jobs.push({ id: newId, ...jobObject });
    }

    jobModal.style.display = 'none';
    saveJobs(); 
};

// H√ÄM M·ªöI: H·ªßy Modal c√¥ng vi·ªác
document.getElementById('cancelJob').onclick = () => {
    jobModal.style.display = 'none';
};

// H√ÄM M·ªöI: X√≥a c√¥ng vi·ªác
document.getElementById('deleteJob').onclick = () => {
    if (editingJobId && confirm('B·∫°n c√≥ ch·∫Øc ch·∫Øn mu·ªën x√≥a n∆°i l√†m vi·ªác n√†y kh√¥ng?')) {
        jobs = jobs.filter(j => j.id !== editingJobId);
        jobModal.style.display = 'none';
        saveJobs(); 
    }
};

// --- KH·ªûI T·∫†O ·ª®NG D·ª§NG ---
function initApp() {
    const storedSettings = JSON.parse(localStorage.getItem('appSettings') || '{}');
    appSettings = storedSettings;

    const initialRate = storedSettings.rate !== undefined ? storedSettings.rate : 100000;
    rateInput.value = initialRate;

    jobs = JSON.parse(localStorage.getItem('jobs') || '[]');

    renderJobList(); 
    renderJobSelectOptions();
    renderCalendar();
    adjustRateInputWidth(); 
}

initApp(); 
</script>
</body>
</html>
