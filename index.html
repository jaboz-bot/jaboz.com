
<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Trang Ch·ªß Jaboz</title>
    <link rel="manifest" href="dashboard.json">
    <meta name="theme-color" content="#1976D2">
    <style>
        body {
            font-family: 'Segoe UI', sans-serif;
            background: #e3f2fd;
            margin: 0;
            padding: 20px 10px 70px 10px; 
            text-align: center;
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
            justify-content: space-between;
            box-sizing: border-box;
        }
        .logo {
            font-size: 42px;
            font-weight: 900;
            background: linear-gradient(135deg, #1976D2 0%, #42A5F5 50%, #66BB6A 100%);
            background-size: 200% 200%;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            letter-spacing: 3px;
            margin-bottom: 10px;
            transition: transform 0.3s ease;
            display: inline-block;
            animation: gradientShift 3s ease infinite, glowPulse 2s ease-in-out infinite;
            filter: drop-shadow(0 0 10px rgba(255, 215, 0, 0.6));
        }
        .logo:hover {
            transform: scale(1.05);
            filter: drop-shadow(0 0 20px rgba(255, 215, 0, 0.9)) drop-shadow(0 0 30px rgba(255, 235, 59, 0.7));
        }
        @keyframes gradientShift {
            0%, 100% {
                background-position: 0% 50%;
            }
            50% {
                background-position: 100% 50%;
            }
        }
        @keyframes glowPulse {
            0%, 100% {
                filter: drop-shadow(0 0 10px rgba(255, 215, 0, 0.6)) drop-shadow(0 0 15px rgba(255, 235, 59, 0.4));
            }
            50% {
                filter: drop-shadow(0 0 20px rgba(255, 215, 0, 0.9)) drop-shadow(0 0 30px rgba(255, 235, 59, 0.7)) drop-shadow(0 0 40px rgba(255, 193, 7, 0.5));
            }
        }
        @media (max-width: 600px) {
            .logo {
                font-size: 32px;
                letter-spacing: 2px;
            }
        }
        h1 {
            color: #1976D2;
            margin-top: 0;
            margin-bottom: 20px;
        }
        .main-container {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 20px;
            max-width: 800px;
            width: 100%;
            margin-bottom: 50px;
        }
        .app-item {
            text-decoration: none;
            color: white;
            padding: 30px 40px;
            border-radius: 12px;
            font-size: 20px;
            font-weight: bold;
            width: 250px;
            text-align: center;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
            transition: transform 0.2s, box-shadow 0.2s;
            cursor: pointer;
        }
        .app-item:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.3);
        }
        .voice-link {
            background: linear-gradient(45deg, #2196F3, #1976D2);
        }
        .game-link {
            background: linear-gradient(45deg, #4CAF50, #388E3C);
        }
        .movie-link {
            background: linear-gradient(45deg, #FF9800, #F57C00);
        }
        .currency-link {
            background: linear-gradient(45deg, #00BCD4, #0097A7);
        }
        .settings-area {
            width: 100%;
            text-align: center;
            position: fixed;
            bottom: 0;
            left: 0;
            z-index: 1000;
            background: rgba(240, 248, 255, 0.95);
            padding: 10px 0;
            box-shadow: 0 -2px 10px rgba(0, 0, 0, 0.1);
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 5px;
        }
        .settings-link {
            background: linear-gradient(45deg, #9C27B0, #7B1FA2);
            padding: 15px 30px;
            font-size: 16px;
            width: auto;
            display: inline-block;
            border-radius: 8px;
            color: white;
            border: none;
            cursor: pointer;
            text-decoration: none;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.3);
        }
        .settings-link:hover {
             transform: translateY(-2px);
             box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
        }
        .visitor-counter {
            margin-top: 0;
            padding: 5px;
            color: #1976D2;
            font-size: 14px;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }
        .visitor-counter .counter-number {
            font-size: 14px;
            font-weight: bold;
        }
        .comment-link {
            background: linear-gradient(45deg, #E91E63, #C2185B);
            padding: 8px 20px;
            font-size: 14px;
            width: auto;
            display: inline-block;
            border-radius: 8px;
            color: white;
            border: none;
            cursor: pointer;
            text-decoration: none;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
            transition: transform 0.2s, box-shadow 0.2s;
        }
        .comment-link:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
        }
        .game-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: #000;
            z-index: 10000;
            margin: 0;
            padding: 0;
        }
        .game-modal.active {
            display: block;
        }
        .game-modal-content {
            width: 100%;
            height: 100%;
            position: relative;
            margin: 0;
            padding: 0;
        }
        .game-iframe {
            width: 100%;
            height: 100%;
            border: none;
            margin: 0;
            padding: 0;
        }
        .close-game-btn {
            display: none;
        }
    </style>
</head>
<body>
    
    <div style="width: 100%; display: flex; flex-direction: column; align-items: center;">
        <div class="logo">JABOZ</div>
        <h1>C√¥ng C·ª• Ti·ªán √çch</h1>
        <div class="main-container">
            
            <a href="tools/may-ho-tro-giong-noi/may-voice.html" class="app-item voice-link">
                üí¨ M√°y H·ªó Tr·ª£ Gi·ªçng N√≥i
            </a>
            
            <div id="gameLink" class="app-item game-link">
                üéÆ Ch∆°i Game              
            </div>
            
            <a href="cham_cong/cham_cong.html" class="app-item movie-link">
                üóìÔ∏è M√°y Ch·∫•m C√¥ng
            </a>
            
            <a href="doi_tien_te/doi_tien_te.html" class="app-item currency-link">
                üí± ƒê·ªïi ti·ªÅn t·ªá
            </a>
            
            <a href="lich_am_duong.html" class="app-item" style="background: linear-gradient(45deg, #FF6B6B, #EE5A6F);">
                üåô L·ªãch √Çm D∆∞∆°ng
            </a>
            
        </div>
    </div>

<div class="settings-area">
    <button class="settings-link" id="installButton">üì≤ Trang Ch·ªß</button>
    <a href="binh_luan/binh_luan.html" class="comment-link">üí¨ ƒê√≥ng g√≥p √Ω ki·∫øn</a>
    <div class="visitor-counter">
        <span>üë• T·ªïng l∆∞·ª£t truy c·∫≠p:</span>
        <span class="counter-number" id="visitorCount">0</span>
    </div>
</div>

<!-- Modal ƒë·ªÉ m·ªü game v√† ·∫©n URL - Full m√†n h√¨nh -->
<div id="gameModal" class="game-modal">
    <div class="game-modal-content">
        <iframe id="gameIframe" class="game-iframe" src=""></iframe>
    </div>
</div>

<script>
    // M·ªü game trong iframe ƒë·ªÉ ·∫©n URL - Full m√†n h√¨nh
    const gameLink = document.getElementById('gameLink');
    const gameModal = document.getElementById('gameModal');
    const gameIframe = document.getElementById('gameIframe');
    
    gameLink.addEventListener('click', () => {
        gameIframe.src = 'https://gamesnacks.com/';
        gameModal.classList.add('active');
        // ·∫®n body scroll khi m·ªü game
        document.body.style.overflow = 'hidden';
    });
    
    // ƒê√≥ng modal b·∫±ng ph√≠m ESC
    document.addEventListener('keydown', (e) => {
        if (e.key === 'Escape' && gameModal.classList.contains('active')) {
            gameModal.classList.remove('active');
            gameIframe.src = '';
            document.body.style.overflow = '';
        }
    });


    // Logic PWA
    let deferredPrompt = null;
    const installButton = document.getElementById('installButton');
    
    function isRunningStandalone() {
        return window.matchMedia('(display-mode: standalone)').matches;
    }
    
    function updateInstallButtonVisibility() {
        installButton.style.display = (!isRunningStandalone() && deferredPrompt) ? 'inline-block' : 'none';
    }
    
    function installApp() {
        if (deferredPrompt) {
            deferredPrompt.prompt();
            deferredPrompt.userChoice.then(() => {
                deferredPrompt = null;
                updateInstallButtonVisibility();
            });
        }
    }
    
    window.addEventListener('beforeinstallprompt', (e) => {
        e.preventDefault();
        deferredPrompt = e;
        updateInstallButtonVisibility();
        if (installButton.style.display !== 'none') {
            installButton.addEventListener('click', installApp, { once: true });
        }
    });
    
    window.addEventListener('appinstalled', () => {
        deferredPrompt = null;
        updateInstallButtonVisibility();
    });
    
    updateInstallButtonVisibility();
    
    // B·ªô ƒë·∫øm l∆∞·ª£t truy c·∫≠p c·ªông d·ªìn v·ªõi Firebase - ƒê·∫øm ch√≠nh x√°c t·ª´ t·∫•t c·∫£ ng∆∞·ªùi d√πng
    (function() {
        const counterEl = document.getElementById('visitorCount');
        if (!counterEl) return;
        
        let currentCount = 0;
        let targetCount = 0;
        let db = null;
        let firebaseInitialized = false;
        
        // Firebase configuration - S·ª≠ d·ª•ng c√πng config v·ªõi binh_luan.html
        const firebaseConfig = {
            apiKey: "AIzaSyBMv04BBtq623wHq5ANafgZTLWB6eI21MQ",
            authDomain: "giang-cdd21.firebaseapp.com",
            projectId: "giang-cdd21",
            storageBucket: "giang-cdd21.firebasestorage.app",
            messagingSenderId: "625032066181",
            appId: "1:625032066181:web:18619aeab6d81207ee65ec",
            measurementId: "G-T77QP608PB"
        };
        
        // Kh·ªüi t·∫°o Firebase
        let firestoreModule = null;
        
        async function initFirebase() {
            try {
                const { initializeApp } = await import('https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js');
                firestoreModule = await import('https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js');
                const { getFirestore } = firestoreModule;
                
                const app = initializeApp(firebaseConfig);
                db = getFirestore(app);
                firebaseInitialized = true;
                
                // TƒÉng l∆∞·ª£t truy c·∫≠p khi trang ƒë∆∞·ª£c t·∫£i
                await incrementVisitorCount();
                
                // L·∫Øng nghe thay ƒë·ªïi t·ª´ Firestore ƒë·ªÉ hi·ªÉn th·ªã real-time
                listenToVisitorCount();
                
                return true;
            } catch (error) {
                console.error('L·ªói kh·ªüi t·∫°o Firebase:', error);
                // Fallback: hi·ªÉn th·ªã s·ªë 0 n·∫øu Firebase kh√¥ng ho·∫°t ƒë·ªông
                counterEl.textContent = '0';
                return false;
            }
        }
        
        // TƒÉng l∆∞·ª£t truy c·∫≠p trong Firestore (c·ªông d·ªìn)
        async function incrementVisitorCount() {
            if (!firebaseInitialized || !db || !firestoreModule) return;
            
            try {
                const { doc, getDoc, setDoc, updateDoc, increment, serverTimestamp } = firestoreModule;
                const VISIT_KEY = 'jaboz_visit_session';
                const TOTAL_COUNT_DOC_ID = 'total';
                const visitDocRef = doc(db, 'visitor_count', TOTAL_COUNT_DOC_ID);
                
                // Ki·ªÉm tra xem ƒë√£ ƒë·∫øm l∆∞·ª£t truy c·∫≠p n√†y ch∆∞a (tr√°nh ƒë·∫øm tr√πng khi refresh)
                const visitData = sessionStorage.getItem(VISIT_KEY);
                let hasVisited = false;
                
                if (visitData) {
                    hasVisited = true;
                }
                
                // Ch·ªâ tƒÉng l∆∞·ª£t truy c·∫≠p n·∫øu ch∆∞a ƒë·∫øm trong session n√†y
                if (!hasVisited) {
                    const visitDoc = await getDoc(visitDocRef);
                    
                    if (visitDoc.exists()) {
                        // Document ƒë√£ t·ªìn t·∫°i, tƒÉng s·ªë ƒë·∫øm b·∫±ng updateDoc v·ªõi increment
                        await updateDoc(visitDocRef, {
                            count: increment(1),
                            lastUpdated: serverTimestamp()
                        });
                    } else {
                        // Document ch∆∞a t·ªìn t·∫°i, t·∫°o m·ªõi v·ªõi count = 1
                        await setDoc(visitDocRef, {
                            count: 1,
                            lastUpdated: serverTimestamp()
                        });
                    }
                    
                    // ƒê√°nh d·∫•u ƒë√£ ƒë·∫øm l∆∞·ª£t truy c·∫≠p n√†y
                    sessionStorage.setItem(VISIT_KEY, JSON.stringify({
                        timestamp: Date.now()
                    }));
                }
            } catch (error) {
                console.error('L·ªói tƒÉng l∆∞·ª£t truy c·∫≠p:', error);
            }
        }
        
        // L·∫Øng nghe thay ƒë·ªïi t·ª´ Firestore
        function listenToVisitorCount() {
            if (!firebaseInitialized || !db || !firestoreModule) return;
            
            try {
                const { doc, onSnapshot } = firestoreModule;
                const TOTAL_COUNT_DOC_ID = 'total';
                const visitDocRef = doc(db, 'visitor_count', TOTAL_COUNT_DOC_ID);
                
                onSnapshot(visitDocRef, (snapshot) => {
                    if (snapshot.exists()) {
                        const data = snapshot.data();
                        targetCount = data.count || 0;
                        updateCounter();
                    } else {
                        targetCount = 0;
                        updateCounter();
                    }
                }, (error) => {
                    console.error('L·ªói l·∫Øng nghe Firestore:', error);
                });
            } catch (error) {
                console.error('L·ªói thi·∫øt l·∫≠p listener:', error);
            }
        }
        
        function animateCount() {
            if (currentCount < targetCount) {
                const diff = targetCount - currentCount;
                const increment = Math.max(1, Math.ceil(diff / 20));
                currentCount = Math.min(currentCount + increment, targetCount);
                counterEl.textContent = currentCount.toLocaleString('vi-VN');
            } else if (currentCount > targetCount) {
                const diff = currentCount - targetCount;
                const decrement = Math.max(1, Math.ceil(diff / 20));
                currentCount = Math.max(currentCount - decrement, targetCount);
                counterEl.textContent = currentCount.toLocaleString('vi-VN');
            }
        }
        
        function updateCounter() {
            function animate() {
                animateCount();
                if (currentCount !== targetCount) {
                    setTimeout(() => {
                        requestAnimationFrame(animate);
                    }, 30);
                }
            }
            requestAnimationFrame(animate);
        }
        
        // Kh·ªüi t·∫°o Firebase v√† b·∫Øt ƒë·∫ßu ƒë·∫øm
        initFirebase();
    })();
</script>

</body>
</html>
