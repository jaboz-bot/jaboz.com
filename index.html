<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>B·∫£ng ƒêi·ªÅu Khi·ªÉn</title>
    <link rel="manifest" href="dashboard.json">
    <meta name="theme-color" content="#1976D2">
    <style>
        body {
            font-family: 'Segoe UI', sans-serif;
            background: #e3f2fd;
            margin: 0;
            padding: 50px 10px;
            text-align: center;
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
            justify-content: space-between;
        }
        h1 {
            color: #1976D2;
            margin-bottom: 40px;
        }
        .main-container {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 20px;
            max-width: 800px;
            width: 100%;
            margin-bottom: 50px;
        }
        .app-link {
            text-decoration: none;
            color: white;
            padding: 30px 40px;
            border-radius: 12px;
            font-size: 20px;
            font-weight: bold;
            width: 250px;
            text-align: center;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
            transition: transform 0.2s, box-shadow 0.2s;
        }
        .app-link:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.3);
        }
        .voice-link {
            background: linear-gradient(45deg, #2196F3, #1976D2);
        }
        .game-link {
            background: linear-gradient(45deg, #4CAF50, #388E3C);
        }
        .movie-link {
            background: linear-gradient(45deg, #FF9800, #F57C00);
        }
        .settings-area {
            width: 100%;
            text-align: center;
            padding-bottom: 30px;
            margin-top: auto;
        }
        .settings-link {
            background: linear-gradient(45deg, #9C27B0, #7B1FA2);
            padding: 15px 30px;
            font-size: 16px;
            width: auto;
            display: inline-block;
            border-radius: 8px;
            color: white; /* Th√™m m√†u ch·ªØ ƒë·ªÉ ƒë·∫£m b·∫£o hi·ªÉn th·ªã */
            border: none; /* Th√™m ƒë·ªÉ ƒë·∫£m b·∫£o tr√¥ng gi·ªëng n√∫t */
            cursor: pointer;
            text-decoration: none;
        }
        .settings-link:hover {
             transform: translateY(-2px);
             box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
        }
    </style>
</head>
<body>
    
    <div style="width: 100%; display: flex; flex-direction: column; align-items: center;">
        <h1>Ch·ªçn ·ª®ng D·ª•ng</h1>
        <div class="main-container">
            
            <a href="tools/may-ho-tro-giong-noi/may-voice.html" class="app-link voice-link">
                üí¨ M√°y H·ªó Tr·ª£ Gi·ªçng N√≥i
            </a>
            
            <a href="choi-game/menu-game.html" class="app-link game-link">
                üéÆ Ch∆°i Game             
            </a>
            
            <a href="tv/tv.html" class="app-link movie-link">
                üé¨ TV Online
            </a>
            
        </div>
    </div>

<div class="settings-area">
    <button id="installButton" class="settings-link" style="display: none;">
        üì≤ C√†i ƒë·∫∑t app
    </button>
</div>

<script>
    // ====================================================================
    // PWA INSTALLATION LOGIC (CHU·∫®N H√ìA)
    // ====================================================================

    let deferredPrompt = null;
    const installButton = document.getElementById('installButton');

    /**
     * @function isRunningStandalone
     * @description Ki·ªÉm tra xem ·ª©ng d·ª•ng c√≥ ƒëang ch·∫°y ·ªü ch·∫ø ƒë·ªô ƒë·ªôc l·∫≠p (standalone - ƒë√£ c√†i ƒë·∫∑t) hay kh√¥ng.
     * @returns {boolean}
     */
    function isRunningStandalone() {
        // Ki·ªÉm tra qua media query c·ªßa tr√¨nh duy·ªát
        return window.matchMedia('(display-mode: standalone)').matches;
    }

    /**
     * @function updateInstallButtonVisibility
     * @description C·∫≠p nh·∫≠t tr·∫°ng th√°i hi·ªÉn th·ªã c·ªßa n√∫t C√†i ƒë·∫∑t.
     */
    function updateInstallButtonVisibility() {
        if (isRunningStandalone()) {
            // ·∫®n n√∫t n·∫øu ƒëang ch·∫°y d∆∞·ªõi d·∫°ng ·ª©ng d·ª•ng ƒë√£ c√†i ƒë·∫∑t
            installButton.style.display = 'none';
            console.log('App is running standalone. Install button hidden.');
        } else if (deferredPrompt) {
            // Hi·ªán n√∫t n·∫øu ƒë·ªß ƒëi·ªÅu ki·ªán c√†i ƒë·∫∑t v√† ch∆∞a ·ªü ch·∫ø ƒë·ªô standalone
            installButton.style.display = 'inline-block';
            console.log('PWA available. Install button shown.');
        } else {
            // ·∫®n n√∫t n·∫øu kh√¥ng ƒë·ªß ƒëi·ªÅu ki·ªán c√†i ƒë·∫∑t ho·∫∑c prompt ch∆∞a ƒë∆∞·ª£c k√≠ch ho·∫°t
            installButton.style.display = 'none';
        }
    }

    /**
     * @function installApp
     * @description K√≠ch ho·∫°t l·ªùi nh·∫Øc c√†i ƒë·∫∑t c·ªßa tr√¨nh duy·ªát khi ng∆∞·ªùi d√πng nh·∫•p v√†o n√∫t.
     */
    function installApp() {
        // T·∫°m th·ªùi ng·∫Øt k·∫øt n·ªëi s·ª± ki·ªán click kh·ªèi n√∫t ƒë·ªÉ tr√°nh click k√©p
        installButton.removeEventListener('click', installApp);

        if (deferredPrompt) {
            // Hi·ªÉn th·ªã h·ªôp tho·∫°i c√†i ƒë·∫∑t
            deferredPrompt.prompt();
            
            // Ch·ªù ƒë·ª£i k·∫øt qu·∫£ l·ª±a ch·ªçn c·ªßa ng∆∞·ªùi d√πng
            deferredPrompt.userChoice.then((choiceResult) => {
                console.log('User choice:', choiceResult.outcome);
                
                // X√≥a prompt ƒë√£ l∆∞u v√† ·∫©n n√∫t b·∫•t k·ªÉ k·∫øt qu·∫£
                deferredPrompt = null;
                updateInstallButtonVisibility(); // S·∫Ω ·∫©n n√∫t n·∫øu deferredPrompt l√† null
            });
        }
    }
    
    // ====================================================================
    // X·ª≠ l√Ω S·ª± ki·ªán PWA
    // ====================================================================

    // S·ª± ki·ªán 1: L∆∞u prompt khi PWA s·∫µn s√†ng ƒë∆∞·ª£c c√†i ƒë·∫∑t
    window.addEventListener('beforeinstallprompt', (e) => {
        e.preventDefault();
        
        // L∆∞u tr·ªØ s·ª± ki·ªán
        deferredPrompt = e;
        // C·∫≠p nh·∫≠t hi·ªÉn th·ªã n√∫t
        updateInstallButtonVisibility();
        
        // G·∫Øn l·∫°i h√†m x·ª≠ l√Ω c√†i ƒë·∫∑t khi prompt m·ªõi ƒë∆∞·ª£c k√≠ch ho·∫°t
        if (installButton.style.display !== 'none') {
            installButton.addEventListener('click', installApp, { once: true });
        }
    });

    // S·ª± ki·ªán 2: ·∫®n n√∫t n·∫øu ·ª©ng d·ª•ng ƒë∆∞·ª£c c√†i ƒë·∫∑t th√†nh c√¥ng (qua b·∫•t k·ª≥ c√°ch n√†o)
    window.addEventListener('appinstalled', () => {
        deferredPrompt = null;
        updateInstallButtonVisibility();
        console.log('App successfully installed.');
    });

    // ====================================================================
    // Kh·ªüi t·∫°o Trang
    // ====================================================================
    
    // ·∫®n n√∫t ngay khi t·∫£i trang n·∫øu ·ª©ng d·ª•ng ƒë√£ ch·∫°y ·ªü ch·∫ø ƒë·ªô standalone
    updateInstallButtonVisibility(); 
    
    // Y√™u c·∫ßu PWA 2: (Kh√¥ng b·∫Øt bu·ªôc) Kh·ªüi t·∫°o Service Worker t·∫°i ƒë√¢y
    // if ('serviceWorker' in navigator) {
    //    window.addEventListener('load', () => {
    //       navigator.serviceWorker.register('/service-worker.js'); 
    //    });
    // }
</script>
</body>
</html>
