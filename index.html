<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>MÃ¡y há»— trá»£ giá»ng nÃ³i</title>
<link rel="manifest" href="manifest.json">
<style>
body{font-family:'Segoe UI',sans-serif;background:#e3f2fd;margin:0;padding:0 0 55px;text-align:center}
/* Chá»‘ng ngÆ°á»i dÃ¹ng vuá»‘t mÃ n hÃ¬nh khi khÃ³a */
body.locked {
    overflow: hidden; 
    overscroll-behavior-y: contain; 
    touch-action: none;
}

.main-wrapper{max-width:700px;margin:0 auto;padding:20px 10px}
h1{margin-bottom:20px}
.locked-h1{position:fixed;top:100px;left:50%;transform:translateX(-50%);width:100%;max-width:700px;margin:0;padding:0 10px;z-index:1000;color:#333;background:#e3f2fd}
.container{display:grid;grid-template-columns:repeat(auto-fit,minmax(240px,1fr));gap:20px;margin-bottom:20px}
.card{background:#fff;padding:18px;border-radius:12px;box-shadow:0 3px 8px rgba(0,0,0,.15);display:flex;flex-direction:column;gap:10px;position:relative}
input{padding:10px;font-size:16px;border-radius:8px;border:1px solid #ccc;width:100%}
.btn{padding:12px;border:none;border-radius:8px;color:white;font-size:16px;cursor:pointer;transition:.3s;display:flex;justify-content:center;align-items:center}
.play-btn{background:linear-gradient(45deg,#4CAF50,#43A047)}
.add-btn,.install-btn{width:200px}
.reset-btn,.settings-btn,.install-btn.large-control-btn{
    width:220px;
    height:50px;
    font-size:18px;
    margin:8px auto;
    display:flex;
    justify-content:center;
    align-items:center;
}
.install-btn{background:linear-gradient(45deg,#00BCD4,#0097A7)} 
.add-btn,.reset-btn{background:linear-gradient(45deg,#2196F3,#1976D2)}
.settings-btn{background:linear-gradient(45deg,#f44336,#d32f2f)}
.delete-btn{position:absolute;top:6px;right:8px;background:transparent;border:none;color:#e53935;font-size:18px;cursor:pointer;padding:0}
#unlock-btn{width:160px;height:60px;display:none;background:linear-gradient(45deg,#f44336,#d32f2f)}
.control-container{display:flex;flex-direction:column;align-items:center;gap:10px;margin-top:20px;transition:.3s;position:relative}
.navigation-group{display:flex;flex-direction:column;align-items:center;gap:15px;margin:25px 0 0}
/* THAY Äá»”I: Sá»­ dá»¥ng touch-action: manipulation; Ä‘á»ƒ Æ°u tiÃªn cÃ¡c sá»± kiá»‡n nháº¥n/cháº¡m */
.control-btn{
    width:150px;height:60px;border-radius:8px;color:white;font-size:18px;border:none;cursor:pointer;transition:.3s;font-weight:bold;display:flex;justify-content:center;align-items:center;
    touch-action: manipulation; 
}
.play-control-btn{background:linear-gradient(45deg,#4CAF50,#43A047)}
.current-btn-color{background:#ff9800}
#settingsArea{margin-top:30px;text-align:center}

/* CSS cho cháº¿ Ä‘á»™ khÃ³a */
.control-container.locked{
    position:fixed;
    top:0;
    left:0;
    width:100%;
    height:100%;
    overflow:hidden;
    z-index:99;
    background:#e3f2fd;
    justify-content: center; 
}
.control-container.locked #add-btn-move,
.control-container.locked #settingsArea {
    display: none !important;
}
.control-container.locked .navigation-group{
    margin:0;
}
.control-container.locked #unlock-btn{
    position:fixed;
    bottom: 80px; 
    left:50%;
    transform:translateX(-50%);
    display:flex;
    z-index:100;
}

/* Cáº­p nháº­t CSS cho Popup: LuÃ´n fixed vÃ  cÄƒn giá»¯a */
#popup{
    position: fixed;
    top: 200px;
    left: 50%;
    transform: translateX(-50%);
    
    background:rgba(0,0,0,.8);
    color:#fff;
    padding:15px 20px;
    border-radius:12px;
    font-size:18px;
    display:none;
    z-index:1000;
    max-width:90%;
    min-width:100px;
    text-align:center;
    transition: opacity 0.5s ease-out; 
}

/* Bá»” SUNG CSS CHO Há»˜P Gá»¢I Ã TÃ™Y CHá»ˆNH */
.suggestion-box {
    position: absolute;
    bottom: calc(100% - 10px); /* Äáº·t ngay BÃŠN TRÃŠN input */
    left: 0;
    right: 0;
    z-index: 1001; /* Äáº£m báº£o hiá»ƒn thá»‹ trÃªn má»i thá»© */
    background: #fff;
    border: 1px solid #ddd;
    border-bottom: none; /* XÃ³a viá»n dÆ°á»›i */
    border-radius: 8px 8px 0 0; /* Bo gÃ³c trÃªn */
    box-shadow: 0 -4px 6px rgba(0, 0, 0, 0.1); /* Äá»• bÃ³ng lÃªn trÃªn */
    max-height: 150px;
    overflow-y: auto;
    text-align: left;
    display: flex; /* Báº¯t Ä‘áº§u Flexbox */
    flex-direction: column-reverse; /* THAY Äá»”I CUá»I CÃ™NG: Láº­t thá»© tá»± Ä‘á»ƒ gá»£i Ã½ má»›i hiá»‡n gáº§n input */
}
.suggestion-item {
/* ... (Giá»¯ nguyÃªn cÃ¡c thuá»™c tÃ­nh suggestion-item) ... */
    padding: 10px;
    cursor: pointer;
    font-size: 16px;
    border-bottom: 1px solid #eee;
    transition: background-color 0.2s;
}
.suggestion-item:last-child {
    border-bottom: none;
}
.suggestion-item:hover {
    background-color: #f0f0f0;
}
/* Káº¾T THÃšC Bá»” SUNG CSS */

#tts-info{position:fixed;bottom:0;left:50%;transform:translateX(-50%);width:100%;max-width:700px;text-align:center;padding:10px;border-top:1px solid #ccc;color:#616161;background:#e3f2fd;font-size:14px;z-index:1010}
#tts-info a{color:#2196F3;text-decoration:none}
</style>
</head>
<body>
<div class="main-wrapper">
<h1 id="mainTitle">MÃ¡y há»— trá»£ giá»ng nÃ³i</h1>
<div class="container" id="buttonContainer"></div>

<div id="popup"></div>

<div class="control-container" id="controlArea">
<button class="btn add-btn" id="add-btn-move" onclick="addButton()">â• ThÃªm cÃ¢u má»›i</button>
<div class="navigation-group">
<button class="control-btn play-control-btn" data-direction="-1">CÃ¢u trÆ°á»›c</button>
<button class="control-btn current-btn-color" data-direction="0">PhÃ¡t láº¡i</button>
<button class="control-btn play-control-btn" data-direction="1">CÃ¢u sau</button>
</div>
<button class="btn" id="unlock-btn" onclick="toggleLock(false)">Má»Ÿ khÃ³a giao diá»‡n</button>
</div>

<div id="settingsArea">
<button class="btn settings-btn" onclick="toggleLock(true)">KhÃ³a giao diá»‡n</button>
<button class="btn install-btn large-control-btn" id="installButton">ğŸ“² CÃ i Ä‘áº·t app</button>
<button class="btn reset-btn" onclick="resetDefaults()">â™»ï¸ Reset máº·c Ä‘á»‹nh</button>
</div>
</div>

<div id="tts-info">Náº¿u khÃ´ng tháº¥y Ã¢m thanh, táº£i <a href="https://play.google.com/store/apps/details?id=com.google.android.tts" target="_blank">Google Play</a></div>

<script>

// Báº®T Äáº¦U PHáº¦N Bá»” SUNG VÃ€ Sá»¬A Äá»”I (ÄÃƒ NHÃšNG Dá»® LIá»†U)

// *** DÃ¡n ná»™i dung file goi-y-tu.json vÃ o Ä‘Ã¢y ***
let wordSuggestions = [
"a", "Ã ", "Ã¡", "Ã¡n", "Ã¡p", "Ã¡y", "áº¥y", "Äƒn", "Ã¢m", "áº§m", 
"áº©n", "áº£nh", "áº¯t", "Ã¡ch", "áº·t", "áº¯c", "áº¡", "Ã¡t", "Ã¡o", "áº¥p", 
"Ã¢u", "ai", "am", "an", "ao", "au", "ax", "ay", "Ã¡", "Ã¡c", 
"Ã¡ng", "Ã¡i", "áº£m", "Ã¡m", "áº¡n", "áº¡o", "áº¡p", "áº¡t", "áº¯c", "áº¯m", 
"áº³m", "áº±n", "Äƒng", "áº¯ng", "áº¯n", "áº¯p", "áº­t", "áº«m", "áº­m", "áº¥t", 
"áº¥c", "áº¥n", "áº­n", "áº§n", "áº¥t", "áº¥c", "áº¥n", "áº§n", "áº¯t", "áº¯p", 
"Ã¢n", "áº©n", "áº­t", "áº«m", "áº­m", "áº¥n", "áº§n", "áº¥t", "áº¥c", "áº­n", 
"áº§n", "áº¯t", "áº¯p", "áº¥n", "Ã¢n", "áº­t", "áº«m", "áº­m", "áº¥t", "áº¥c", 
"áº¥n", "áº§n", "áº¯t", "áº¯p", "Ã¢n", "áº¥n", "áº§n", "áº¥t", "áº¥c", "Ã¢n", 
"áº¥n", "áº§n", "áº­t", "áº«m", "áº­m", "áº¥t", "áº¥c", "áº¥n", "áº§n", "áº¯t"
    
, "ba", "bÃ ", "bÃ¡c", "bÃ¡n", "bÃ¡nh", "báº¡n", "báº­t", "báº£o", "báº¿", "bÃªn", 
"báº¿p", "bá»‹", "biáº¿t", "bÃ¬nh", "bá»‘", "buá»“n", "bÃºn", "báº©n", "bÃ³ng", "bá»¥ng", 
"bÆ°á»›c", "bá»¥i", "bÆ°ng", "bÃºt", "bá»", "bá»›t", "bá»›i", "bá»›i", "báº£y", "báº£y", 
"báº¥m", "báº«y", "báº­n", "báº­t", "báº©n", "báº¯p", "báº¯p", "báº¯p", "báº¯p", "báº¿p", 
"báº¿n", "bÃ¨o", "bÃªu", "báº¿u", "báº½", "báº»", "bá»‰", "bá»‹t", "bÃ¬", "bÃ²", 
"bá»›t", "bá»›i", "bÆ¡", "bá»", "bá»©a", "bá»©c", "bÃºp", "bá»™t", "bá»™", "bá»“ng", 
"bá»—ng", "bÃ³ng", "bÃ£i", "báº£ng", "bÃ nh", "bÃ ng", "bÃ¡ng", "báº¡n", "báº£o", "bÃ¡o", 
"bÃ¡n", "báº¡c", "bÃ¡t", "báº¥t", "báº¯n", "báº¯t", "báº¥t", "báº§n", "báº­n", "báº­n", 
"báº£o", "bÃ¡o", "bÃ¡n", "báº¡c", "bÃ¡t", "báº­t", "bÃ¡n", "báº¡c", "bÃ¡t", "báº¥t"
    
, "ca", "cÃ¡", "cÃ ", "cáº£", "cáº£m", "can", "canh", "cao", "cÃ¡p", 
"cÃ¡t", "cáº¯t", "cáº§u", "cÃ¢u", "cáº§m", "cÃ¢n", "cáº·p", "cáº¥p", "cáº­p", 
"cáº­t", "cáº­n", "cáº£", "cáº£m", "cáº§n", "cáº©n", "cáº­n", "cÃ¢m", "cÅ©ng", 
"cÃ¹ng", "cung", "cung", "cá»¥c", "cÃºc", "cá»§a", "cá»§i", "cÅ©", "cÃº", 
"cÃºp", "cÆ°á»i", "cÆ°á»›i", "cÆ°á»›i", "cá»­a", "cÆ°Æ¡ng", "cÆ°Æ¡ng", "cÆ°á»›c", 
"cÆ°Æ¡ng", "cÆ°Æ¡ng", "cÆ°á»›c", "cÆ°á»i", "cá»§a", "cá»§i", "cá»¥", "cá»¥c", "cá»±c", 
"cá»©", "cá»©u", "cá»©t", "cÆ¡", "cá»", "cá»", "cÃ³p", "cÃ³t", "cá»c", "cá»", 
"cá»‘i", "cÃ´ng", "cá»•ng", "cá»™ng", "cá»¡", "chÃ ", "cháº¯c", "cháº¯n", "cháº¯c", 
"cháº¯n", "cháº·t", "cháº­n", "cháº­t", "chÃ¢m", "cháº¥m", "cháº·n", "cháº¯p", "cháº¥t"
    
, "da", "dáº¡", "dÃ¡n", "dÃ nh", "danh", "dao", "dáº¡o", "dáº¡ng", "dÃ¡n", "dáº¡t", 
"dáº­y", "dÃ i", "dÃ y", "dáº«n", "dáº§n", "dáº·n", "dáº·n dÃ²", "dáº¥m", "dáº§n", "dÃ¢n", 
"dÃ©p", "dá»‹ch", "dá»‹p", "dá»‹", "dÄ©a", "dÄ©", "dÄ© nhiÃªn", "dÄ© vÃ£ng", "dÄ© nhiÃªn", 
"dÃ­nh", "dÃ²ng", "dÃµi", "dá»—i", "dá»‘i", "dá»Ÿ", "dá»n", "dá»n", "dá»Ÿ", "dÃµi", 
"dá»—i", "dá»—i", "dá»‘i", "dá»Ÿ", "dá»n", "dá»n", "dá»Ÿ", "dÃµi", "dá»‘i", "dá»—i", 
"dá»‘i", "dá»Ÿ", "dá»n", "dá»n", "dá»…", "dÄ© nhiÃªn", "dÄ© vÃ£ng", "dÄ© nhiÃªn", 
"dÄ© vÃ£ng", "dÅ©ng", "dÆ°á»›i", "dÃ¹ng", "dá»±a", "dá»¯", "dá»¯ dáº±n", "dá»©t", "dÆ°á»›i", 
"dÃ¹ng", "dá»±a", "dá»¯", "dá»©t", "dÆ°á»›i", "dÃ¹ng", "dÆ°á»›i", "dÃ¹ng", "dá»©t", "dÆ°á»›i", 
"dÃ¹ng", "dá»©t", "dÆ°á»›i", "dÃ¹ng", "dÆ°á»›i", "dÃ¹ng", "dá»©t", "dÆ°á»›i", "dÃ¹ng", "dá»©t"
    
, "Ä‘Ã¡", "Ä‘au", "Ä‘áº¿n", "Ä‘i", "Ä‘Ã³ng", "Ä‘á»‘i", "Ä‘Ã³n", "Ä‘Æ°a", "Ä‘Æ°á»£c", "Ä‘á»©ng", 
"Ä‘Ã²i", "Ä‘Ã³", "Ä‘Ã´i", "Ä‘á»", "Ä‘á»™", "Ä‘á»“n", "Ä‘á»£i", "Ä‘Ã³i", "Ä‘Æ¡n", "Ä‘Æ¡n", 
"Ä‘Ã´ng", "Ä‘á»ng", "Ä‘á»•i", "Ä‘á»‘i", "Ä‘á»©a", "Ä‘á»¥c", "Ä‘á»§", "Ä‘un", "Ä‘Ãºng", "Ä‘Ãºp", 
"Ä‘Ãºp", "Ä‘á»©t", "Ä‘á»©t", "Ä‘á»©t", "Ä‘á»©t", "Ä‘á»«ng", "Ä‘Æ°á»ng", "Ä‘Ã¡ng", "Ä‘áº¡p", "Ä‘áº·t", 
"Ä‘áº¯p", "Ä‘áº¡t", "Ä‘áº¥t", "Ä‘Ã£", "Ä‘Ã£", "Ä‘Ã£", "Ä‘Ã£", "Ä‘Ã¡", "Ä‘Ã¡", "Ä‘Ã¡", 
"Ä‘Äƒng", "Ä‘Ã¡ng", "Ä‘Ã¡p", "Ä‘Ã¡p", "Ä‘áº¡t", "Ä‘áº¯t", "Ä‘áº¯c", "Ä‘áº·c", "Ä‘áº¯n", "Ä‘áºµn", 
"Ä‘áº¥m", "Ä‘áº«m", "Ä‘áº­m", "Ä‘áº§y", "Ä‘Ã¢y", "Ä‘á»ƒ", "Ä‘áº¿n", "Ä‘áº¿n", "Ä‘áº¿n", "Ä‘áº¿n", 
"Ä‘Ã¨n", "Ä‘á»n", "Ä‘áº»", "Ä‘áº½o", "Ä‘Ä©a", "Ä‘Ä©", "Ä‘á»‹nh", "Ä‘inh", "Ä‘inh", "Ä‘inh", 
"Ä‘Ã´i", "Ä‘á»“i", "Ä‘Ã²i", "Ä‘á»£i", "Ä‘Ã³i", "Ä‘Ã³n", "Ä‘á»™", "Ä‘á»“", "Ä‘á»™i", "Ä‘á»i"
    
, "e", "Ã¨", "Ã©", "áº»", "áº½", "áº¹", "em", "Ã©n", "eo", "Ã©p", 
"Ã©t", "eo", "em", "en", "en", "em", "Ã©n", "eo", "Ã©p", "Ã©t"
    
, "Ãª", "á»", "áº¿", "á»ƒ", "á»…", "á»‡", "Ãªm", "Ãªn", "áº¿p", "áº¿t", 
"Ãª", "á»", "áº¿", "á»ƒ", "Ãªm", "Ãªn", "áº¿p", "áº¿t", "áº¿ch"
    
, "ga", "gÃ ", "gÃ¡c", "gÃ¡i", "gáº§n", "gáº¥m", "gáº¯p", "gáº­y", "ghen", 
"giao", "giao", "giÃ ", "giÃ¡c", "giÃ£y", "giáº­n", "giáº·t", "giáº¥y", "giáº¿ng", 
"giá»¯", "giÃºp", "giÆ°á»ng", "giáº£", "giáº£m", "giÃ¡n", "giÃ¡n", "giÃ¡p", "giáº­t", 
"gÃ³p", "gá»¡", "gá»—", "gá»‘i", "gá»ng", "gá»i", "gá»­i", "gá»‘i", "gá»«ng", 
"gÃ£y", "ghen", "ghÃ©t", "gháº¿", "ghÃ¬", "ghÃ¬m", "ghÃ¬", "ghim", "ghÃ©t", 
"gháº¿", "gÃ³i", "gÃ³t", "gÃ³t", "gÃ³t", "gá»i", "gáº§n", "gáº§n", "gáº¥p", 
"gáº¥p", "gáº¯m", "gáº¯m", "gÄƒng", "gáº¯ng", "gÃ£y", "gÃ£y", "gáº§y", "ghen", 
"ghen", "gÃ³p", "gá»‘c", "gá»‘i", "gÃ³p", "gá»‘c", "gá»‘i", "gÃ¢n", "gáº¡n", 
"gáº¡t", "gáº¡t", "gáº¡t", "gáº·t", "gáº·t", "gáº¯m", "gÄƒm", "gÄƒm", "gÄƒm", 
"gáº§m", "gáº§m", "gáº§m", "gáº§m", "gáº§n", "gáº§n", "gáº§n", "gáº§n", "gáº§n", 
"gáº§m", "gáº§m", "gáº§m", "gáº§m", "gáº§n"
    
, "ha", "hÃ ", "háº¡c", "hÃ¡i", "hÄƒm", "hÃ n", "hÃ ng", "hÃ¡t", "háº§u", "hÃ£y", 
"hai", "hÃ ng", "háº¡nh", "háº¡nh", "háº¹n", "háº¿t", "hi", "hiá»‡n", "hiáº¿u", "há»", 
"há»“", "há»™p", "há»£p", "há»‘t", "há»©a", "hÃ¹m", "hÃ¹ng", "hÃºt", "hÆ°", "há»¯u", 
"hay", "háº¹p", "hÃ¨n", "há»", "hÃ¨", "hÃ©o", "há»…", "hÃ­t", "hÃ²n", "há»£p", 
"há»›p", "há»Ÿ", "há»Ÿ", "há»•", "há»—", "há»‘i", "há»i", "há»‘t", "há»™t", "há»™t", 
"hoa", "hoÃ ", "hoáº¡c", "hoÃ¡n", "hoáº¡t", "hoÃ ", "hoÃ¡n", "hoáº¡t", "hÃ³a", "hoÃ¡", 
"hoáº·c", "hoÃ ng", "hoang", "hoÃ ng", "hoang", "hoÃ i", "hoÃ£i", "hoÃ£n", "hoáº¡n", "hoáº¡n", 
"há»c", "hÃ³c", "há»“n", "há»•ng", "há»“ng", "há»‘t", "hÆ¡n", "hÆ¡n", "há»›p", "há»›p", 
"há»a", "há»a", "há»a", "há»a", "há»a", "há»a", "há»a", "há»a", "há»a", "há»a"

, "i", "Ã¬", "Ã­", "á»‰", "Ä©", "á»‹", "ia", "Ã­ch", "Ã­t", "in", "in", "Ã­t", "im", "Ã­m", "á»‰m"

, "káº»", "kÃ©m", "kÃ©o", "káº¹p", "kÃª", "ká»‡", "kÃ­", "kÃ¬", "kÃ­p", "kÃ­t", 
"kiáº¿m", "kÄ©", "kiÃªng", "kiá»‡n", "kÃ­n", "kÃ­nh", "ká»³", "kÃ½", "ká»¹", "kÃ¨o", 
"káº¿t", "kÃ¨n", "kÃ¨n", "kÃ©o", "káº¹p", "káº½", "káº¹o", "kÃ©t", "kÃªu", "kÃªu", 
"kÃª", "ká»‡", "ká»‡", "kÃªnh", "ká»ƒ", "kÃ©n", "káº¿t", "káº»", "kÃ©m", "kÃ©o", 
"kÃ¬m", "kÃ­n", "kÃ¬nh", "ká»‹p", "kÃ­nh", "ká»‹p", "kÃ­nh", "ká»¹", "ká»¹", "ká»·", 
"ká»·", "ká»·", "ká»·", "kÃ½", "ká»³", "ká»·", "kÃ½", "ká»·", "ká»³", "ká»·", 
"kÃ½", "ká»³", "ká»·", "kÃ½", "ká»³", "ká»·", "kÃ½", "ká»³", "ká»·", "kÃ½", 
"ká»·", "kÃ½", "ká»³", "ká»·", "kÃ½", "ká»·", "ká»³", "ká»·", "kÃ½", "ká»·", 
"ká»·", "kÃ½", "ká»³", "ká»·", "kÃ½", "ká»·", "ká»³", "ká»·", "kÃ½", "ká»·"

, "la", "lÃ ", "lÃ¡c", "lÃ¡i", "láº¯m", "lÃ m", "lan", "lÃ¡ng", "lÃ£o", "lÃ£o", 
"láº¥y", "láº¯m", "lÃ m", "láº§n", "láº¡i", "láº¡i", "láº¡i", "láº¡i", "láº¡i", "lÃ m", 
"lÃªn", "lá»‡", "láº½", "lÃ©p", "lÃ©p", "lÃ©p", "lÃ©p", "lÃ©p", "láº»", "láº»", 
"láº»", "láº»", "láº»", "láº»", "lÃªn", "lÃªn", "lÃªn", "lÃªn", "lÃªn", "lÃªn", 
"lÃªu", "lÃªu", "lÃªu", "lÃªu", "lÃªu", "lÃªu", "lÃªu", "lÃªu", "lÃªu", "lÃªu", 
"li", "lÃ¬", "lá»‹ch", "liáº¿c", "liáº¿c", "liáº¿c", "liáº¿c", "liáº¿c", "liáº¿c", "liáº¿c", 
"lo", "lÃ²", "lÃ²ng", "lá»c", "lÃ³c", "lá»›n", "lá»›p", "lá»›p", "lá»›p", "lá»›p", 
"lÆ°á»›i", "lá»­a", "lá»§i", "lÃ¹i", "lÃ¹ng", "lÃºng", "luá»™c", "luÃ´n", "luá»™t", "luáº­t", 
"lÆ°u", "lÆ°u", "lÆ°u", "lÆ°u", "lÆ°u", "lÆ°u", "lÆ°u", "lÆ°u", "lÆ°u", "lÆ°u"

, "ma", "mÃ ", "mÃ¡c", "mÃ¡i", "mÄƒm", "mÃ n", "mang", "mÃ¡t", "mau", "may", 
"mÃ y", "mÃ£", "mÃ£nh", "máº¡nh", "máº¯n", "máº­t", "máº·t", "máº§m", "máº·n", "máº¥t", 
"máº¯c", "mÃ¢m", "máº¯ng", "máº·c", "máº¹", "mÃ©o", "máº»", "mÃ©p", "mÃ©p", "má»‡t", 
"mÃ¨o", "máº¹o", "mÃ¨o", "máº¹o", "mÃ¨o", "máº¹o", "mÃ¨o", "máº¹o", "mÃªu", "mÃªu", 
"mÃ­a", "mÃ¬", "mÃ­t", "mÃ­t", "mÃ­t", "má»‹t", "mÃ­t", "má»‹t", "mÃ­t", "má»‹t", 
"mo", "mÃ²", "mÃ³c", "má»‘c", "má»", "má»i", "má»i", "má»›i", "má»ng", "má»ng", 
"má»™ng", "má»‘t", "má»‘t", "má»Ÿ", "má»Ÿ", "má»›i", "má»›i", "má»›i", "mÅ©", "má»¥c", 
"muá»‘i", "muá»™n", "muÃ´n", "muá»‘n", "mua", "mua", "mua", "mua", "má»¥c", "má»¥c", 
"má»«ng", "má»«ng", "má»©c", "má»±c", "má»±c", "má»±c", "mÆ°á»i", "mÆ°á»i", "mÆ°á»i", "mÆ°á»i"

, "na", "nÃ ", "nÃ¡c", "nÃ¡i", "nÄƒm", "nan", "nang", "nÃ ng", "nÃ¡o", "nÃ¡t", 
"nau", "nay", "nÃ y", "nÄƒng", "náº·ng", "náº¯n", "náº¯p", "náº¯t", "náº¯ng", "náº¿u", 
"nÃ©n", "ná»n", "náº¿p", "nÃ©t", "nÃªu", "ná»­a", "ná»­a", "ná»¯a", "ná»¯", "ná»¯a", 
"ná»­a", "ná»¯", "nhiá»u", "nhÃ ", "nhÃ¬n", "nhá»", "nhá»›", "nhá»", "nhá»›", "nhá»", 
"nhá»›", "nhá»", "nhá»›", "nhá»", "nhá»›", "nhá»", "nhá»›", "nhá»", "nhá»›", "nhá»", 
"no", "nÃ²", "nÃ³i", "nÃ³n", "nÃ³t", "nÃ³i", "nÃ³n", "nÃ³t", "nÃ³i", "nÃ³n", 
"nÆ°á»›c", "nÆ°á»›c", "nÆ°á»›c", "nÆ°á»›c", "nÆ°á»›c", "nÆ°á»›c", "nÆ°á»›c", "nÆ°á»›c", "nÆ°á»›c", "nÆ°á»›c", 
"non", "non", "non", "non", "non", "non", "non", "non", "non", "non", 
"ná»£", "ná»£", "ná»£", "ná»£", "ná»£", "ná»£", "ná»£", "ná»£", "ná»£", "ná»£", 
"nÃªn", "nÃªn", "nÃªn", "nÃªn", "nÃªn", "nÃªn", "nÃªn", "nÃªn", "nÃªn", "nÃªn"

, "o", "Ã²", "Ã³", "á»", "Ãµ", "á»", "oan", "oÃ¡n", "oÃ¡t", "oÃ¡ch", 
"oai", "oáº£i", "oa", "oÃ ", "oÃ¡", "oÃ£", "oáº¡", "oen", "oeo"

, "Ã´", "á»“", "á»‘", "á»•", "á»—", "á»™", "Ã´m", "Ã´n", "á»‘p", "á»‘t", 
"Ã´ng", "á»‘c", "á»•n", "á»™", "á»“n", "á»‘m", "á»‘p", "á»‘t", "á»•n"

, "Æ¡", "á»", "á»›", "á»Ÿ", "á»¡", "á»£", "Æ¡n", "Æ¡i", "á»›t", "á»›n", 
"Æ¡m", "Æ¡m", "á»›", "á»£", "á»›", "á»£", "á»›t", "á»›n"

, "pha", "phÃ¡", "pháº£i", "phÃ¢n", "pháº³ng", "phÃ¡t", "phÃ¡t", "phÃ¡t", "phÃ¡t", "phÃ¡",
"pháº£i", "phÃ¢n", "pháº©m", "pháº­n", "pháº§n", "phong", "phá»ng", "phÃ²ng", "phá»ng", "phong", 
"phÃ´ng", "phÃºt", "phá»¥c", "phá»¥c", "phá»¥c", "phá»¥c", "phá»¥c", "phá»¥c", "phÃ¹", "phÃ¹", 
"phÃ¹", "phÃ¹", "phÃ¹", "phÃ¹", "phÃ¹", "phÃ¹", "phÃ¹", "phÃ¹", "phÃ¹", "phÃ¹"

, "qua", "quÃ¡", "quÃ¡n", "quang", "quÃ¡t", "quÃ¢n", "quáº­n", "quáº§n", "quáº§n", 
"quÃ¡", "quÃ¡n", "quang", "quÃ¡t", "quÃ¢n", "quáº­n", "quÃ¡", "quÃ¡", "quÃ¡n", 
"quang", "quÃ¡t", "quÃ¢n", "quáº­n", "quÃ¡", "quÃ¡", "quÃ¡n", "quang", "quÃ¡t", 
"quÃ¢n", "quáº­n", "quÃ¡n", "quang", "quÃ¡t", "quÃ¢n", "quáº­n", "quÃ¡n", "quang", 
"quÃ¡t", "quÃ¢n", "quáº­n", "quÃ¡n", "quang", "quÃ¡t", "quÃ¢n", "quáº­n", "quÃ¡n", 
"quang", "quÃ¡t", "quÃ¢n", "quáº­n"

, "ra", "rÃ¡", "rÃ¡c", "rÃ¡i", "rÄƒm", "ranh", "rao", "rÃ¡p", "rÃ¡t", "rau", 
"rÃ y", "rÃ o", "ráº¯c", "ráº·n", "ráº±ng", "ráº¯n", "ráº¯p", "ráº¯t", "rÃ¢u", "rÃ¢y", 
"ráº½", "ráº»", "rÃ¨n", "rÃ¨n", "rÃ¨n", "rÃ¨n", "rÃªu", "rÃª", "rÃª", "rÃª", 
"rÃ¬", "rÃ¬", "rá»‰", "rÃ­t", "rÃ¬nh", "rá»‰", "rá»‰", "rá»‰", "rá»‰", "rá»", 
"rÃ³c", "rÃ³c", "rÃ³c", "rÃ³c", "rá»“i", "rá»“i", "rá»“i", "rá»“i", "rÃ´ng", "rá»™ng", 
"rá»™ng", "rá»™ng", "rá»›t", "rá»›t", "rá»›t", "rá»›t", "rÃºt", "rÃºt", "rÃºt", "rÃºt", 
"rá»­a", "rá»­a", "rá»­a", "rá»­a", "rá»¯a", "rá»¯a", "rá»¯a", "rá»¯a", "rá»±c", "rá»±c", 
"rá»±c", "rá»±c", "rá»«ng", "rá»«ng", "rá»«ng", "rá»«ng", "rá»¥ng", "rá»¥ng", "rá»¥ng", "rá»¥ng"

, "sa", "sÃ ", "sÃ¡c", "sÃ¡i", "sáº¯m", "san", "sang", "sÃ¡ng", "sao", "sÃ¡t", 
"sau", "say", "sáº¯c", "sáºµn", "sáºµn", "sáºµn", "sáº¯c", "sáº¯n", "sáº¯n", "sÃ¡p", 
"sáº¯t", "sáº¯p", "sáº¯p", "sáº¯p", "sáº¯p", "sáº¯p", "sáº¯t", "sáº¯p", "sáº¯t", "sáº¯p", 
"sáº½", "sáº»", "sáº»", "sáº»", "sáº»", "sáº»", "sáº¿p", "sáº¿p", "sáº¿p", "sá»‡t", 
"sÃªu", "sÃªu", "sÃªu", "sÃªu", "si", "sÄ©", "sá»‰", "sÄ©", "sÄ©", "sÄ©", 
"so", "sÃ²", "sÃ³c", "sÃ³c", "sÃ³c", "sÃ³t", "sÃ³t", "sÃ³t", "sá»t", "sÃ³t", 
"sÃ³t", "sÃ³t", "sÃ³t", "sÃ³c", "sÃ³c", "sÃ³c", "sÃ³c", "sÃ³c", "sÃ³c", "sÃ³c", 
"sÆ¡n", "sÆ¡n", "sÆ¡n", "sÆ¡n", "sÆ¡n", "sÆ¡n", "sá»Ÿ", "sá»Ÿ", "sá»Ÿ", "sá»Ÿ", 
"sÃºt", "sÃºt", "sÃºt", "sÃºt", "sÃºt", "sÃºt", "suy", "suy", "suy", "suy", 
"suy", "suy", "sá»±", "sá»±", "sá»±", "sá»±", "sá»±", "sá»±", "sá»±", "sá»±"

, "ta", "tÃ ", "tÃ¡c", "táº¡i", "táº¯m", "tan", "tang", "tÃ¡n", "tÃ¡n", "tÃ¡t",
"tay", "tÃ¢y", "tÃ¡c", "tÃ¢n", "táº§ng", "táº­n", "táº­p", "tÃ¢m", "táº¥m", "táº§m",
"táº¯t", "tÄƒng", "táº¥n", "táº¥n", "táº§m", "tÃ¢m", "táº¥m", "táº§m", "táº¯t", "tÄƒm",
"te", "tÃ¨", "tÃ©p", "táº»", "tÃªn", "tÃªn", "tÃªn", "tÃªn", "tÃªn", "tÃªn",
"thÆ°a", "thá»©", "thua", "thua", "thua", "thua", "thÃ¹ng", "thÃ¹ng", "thÃ¹ng", "thÃ¹ng",
"thÆ°Æ¡ng", "thÆ°Æ¡ng", "thÆ°Æ¡ng", "thÆ°Æ¡ng", "thÆ°", "thÆ°", "thÆ°", "thÆ°", "thÆ°", "thÆ°",
"tÃ´i", "tá»›i", "tá»‘i", "tá»‘n", "tÃ³c", "tÃ³c", "tÃ³c", "tÃ³c", "tÃ³c", "tÃ³c",
"trÃ ", "trÃ ", "trÃ ", "trÃ ", "trÃ ", "trÃ ", "tráº£", "tráº£", "tráº£", "tráº£",
"trÄƒm", "trÄƒm", "trÄƒm", "trÄƒm", "trÄƒm", "trÄƒm", "tráº¯ng", "tráº¯ng", "tráº¯ng", "tráº¯ng"

, "u", "Ã¹", "Ãº", "á»§", "Å©", "á»¥", "uÃ½", "uá»·", "uáº¥t", "uáº¥n", 
"uáº­t", "uÃ¢n", "uá»‘ng", "uá»‘n", "uá»‘ng", "ui", "uÃ´n", "uÃ½t", "Ãºi"

, "Æ°", "á»«", "á»©", "á»­", "á»¯", "á»±", "Æ°a", "á»©c", "Æ°á»›t", "Æ°Æ¡m", 
"Æ°Æ¡n", "Æ°Æ¡c", "Æ°Æ¡t", "Æ°Æ¡n", "Æ°Æ¡ng", "á»©ng", "á»©", "á»©", "á»©", "á»©ng"

, "va", "vÃ ", "vÃ¡c", "vÃ¡i", "vÄƒn", "vang", "vÃ o", "vÃ o", "vÃ o", "vÃ o", 
"váº¥t", "váº·t", "vÄƒn", "vÄƒn", "vÄƒn", "vÄƒn", "vÄƒn", "vÄƒn", "vÄƒn", "vÄƒn", 
"váº­y", "vÃ¢y", "vá»", "váº½", "váº½", "váº½", "váº½", "váº½", "váº½", "váº½", 
"vÃ¬", "vá»‹", "vá»‹", "vá»‹", "vá»‹", "vá»‹", "vá»‹", "vá»‹", "vá»‹", "vá»‹", 
"vÃ´", "vÃ´", "vÃ´", "vÃ´", "vÃ´", "vÃ´", "vÃ´", "vÃ´", "vÃ´", "vÃ´", 
"vÃ²ng", "vÃ²ng", "vÃ²ng", "vÃ²ng", "vÃ²ng", "vÃ²ng", "vÃ²ng", "vÃ²ng", "vÃ²ng", "vÃ²ng", 
"vá»ng", "vá»ng", "vá»ng", "vá»ng", "vá»ng", "vá»ng", "vá»ng", "vá»ng", "vá»ng", "vá»ng", 
"vá»›i", "vá»›i", "vá»›i", "vá»›i", "vá»›i", "vá»›i", "vá»›i", "vá»›i", "vá»›i", "vá»›i", 
"vui", "vui", "vui", "vui", "vui", "vui", "vui", "vui", "vui", "vui", 
"vÃ¹ng", "vÃ¹ng", "vÃ¹ng", "vÃ¹ng", "vÃ¹ng", "vÃ¹ng", "vÃ¹ng", "vÃ¹ng", "vÃ¹ng", "vÃ¹ng"

, "xa", "xÃ ", "xÃ¡c", "xÃ¡ch", "xanh", "xan", "xang", "xÃ¡ng", "xao", "xÃ¡t",
"xÃ¢y", "xáº£y", "xÃ£", "xÃ£", "xÃ£", "xÃ£", "xÃ£", "xÃ£", "xÃ£", "xÃ£",
"xÄƒm", "xÄƒm", "xÄƒm", "xÄƒm", "xÄƒm", "xÄƒm", "xÄƒm", "xÄƒm", "xÄƒm", "xÄƒm",
"xáº¿p", "xáº¿p", "xáº¿p", "xáº¿p", "xáº¿p", "xáº¿p", "xáº¿p", "xáº¿p", "xáº¿p", "xáº¿p",
"xem", "xem", "xem", "xem", "xem", "xem", "xem", "xem", "xem", "xem",
"xáº¿p", "xáº¿p", "xáº¿p", "xáº¿p", "xáº¿p", "xáº¿p", "xáº¿p", "xáº¿p", "xáº¿p", "xáº¿p",
"xÃ­", "xÃ­", "xÃ­", "xÃ­", "xÃ­", "xÃ­", "xÃ­", "xÃ­", "xÃ­", "xÃ­",
"xÃ³a", "xÃ³a", "xÃ³a", "xÃ³a", "xÃ³a", "xÃ³a", "xÃ³a", "xÃ³a", "xÃ³a", "xÃ³a",
"xÃ´ng", "xÃ´ng", "xÃ´ng", "xÃ´ng", "xÃ´ng", "xÃ´ng", "xÃ´ng", "xÃ´ng", "xÃ´ng", "xÃ´ng",
"xÆ°a", "xÆ°a", "xÆ°a", "xÆ°a", "xÆ°a", "xÆ°a", "xÆ°a", "xÆ°a", "xÆ°a", "xÆ°a"

, "y", "Ã½", "á»·", "yÃªn", "yÃªu", "yÃªu", "yÃªn", "yÃªu", "yáº¿u", "yáº¿u",
"yáº¿t", "yáº¿m", "yáº¿m", "yá»ƒm", "yá»ƒm", "yá»ƒm", "yáº¿u", "yáº¿u", "yáº¿u", "yáº¿u"
];
// **********************************************


// HÃ€M Sá»¬A Äá»”I: Sá»­ dá»¥ng startsWith() Ä‘á»ƒ Æ°u tiÃªn cÃ¡c tá»«/cá»¥m tá»« báº¯t Ä‘áº§u báº±ng Ä‘áº§u vÃ o
function showSuggestions(inputElement, boxElement) {
// ...

// HÃ€M Sá»¬A Äá»”I: Sá»­ dá»¥ng startsWith() Ä‘á»ƒ Æ°u tiÃªn cÃ¡c tá»«/cá»¥m tá»« báº¯t Ä‘áº§u báº±ng Ä‘áº§u vÃ o
function showSuggestions(inputElement, boxElement) {
    const inputText = inputElement.value.trim().toLowerCase();
    boxElement.innerHTML = '';
    
    if (inputText.length === 0) {
        boxElement.style.display = 'none';
        return;
    }

    // THAY Äá»”I: DÃ¹ng startsWith() Ä‘á»ƒ tÃ¬m cÃ¡c tá»« báº¯t Ä‘áº§u chÃ­nh xÃ¡c báº±ng input
    const filteredSuggestions = wordSuggestions
        .filter(phrase => phrase.toLowerCase().startsWith(inputText))
        .slice(0, 4); // CHá»ˆ GIá»šI Háº N 4 Gá»¢I Ã Äáº¦U TIÃŠN
        
    if (filteredSuggestions.length > 0) {
        filteredSuggestions.forEach(phrase => {
            const item = document.createElement('div');
            item.className = 'suggestion-item';
            item.textContent = phrase;
            
            // Xá»­ lÃ½ khi click vÃ o má»¥c gá»£i Ã½ (dÃ¹ng mousedown Ä‘á»ƒ ngÄƒn input blur ngay láº­p tá»©c)
            item.addEventListener('mousedown', (e) => {
                e.preventDefault(); 
                
                // Bá»” SUNG LOGIC THAY THáº¾ CHá»ˆ PHáº¦N CUá»I CÃ™NG
                // Náº¿u ngÆ°á»i dÃ¹ng Ä‘ang gÃµ má»™t cÃ¢u, chá»‰ thay tháº¿ tá»« cuá»‘i cÃ¹ng
                let fullText = inputElement.value;
                const lastSpaceIndex = fullText.lastIndexOf(' ');
                
                if (lastSpaceIndex !== -1) {
                    // Thay tháº¿ tá»« Ä‘ang gÃµ báº±ng tá»« gá»£i Ã½
                    inputElement.value = fullText.substring(0, lastSpaceIndex + 1) + phrase;
                } else {
                    // Náº¿u lÃ  tá»« Ä‘áº§u tiÃªn, thay tháº¿ toÃ n bá»™
                    inputElement.value = phrase;
                }
                
                boxElement.style.display = 'none';
                saveAll(); 
                inputElement.focus();
            });

            boxElement.appendChild(item);
        });
        boxElement.style.display = 'block';
    } else {
        boxElement.style.display = 'none';
    }
}
// Káº¾T THÃšC PHáº¦N Bá»” SUNG

let deferredPrompt,currentIndex=0,defaults=["TÃ´i muá»‘n Äƒn cÆ¡m","TÃ´i muá»‘n uá»‘ng nÆ°á»›c","TÃ´i muá»‘n Ä‘i vá»‡ sinh","TÃ´i muá»‘n Ä‘i ngá»§"],installState = 'before_install';
const controlArea=document.getElementById('controlArea'),
Â  Â  Â  installButton=document.getElementById('installButton'),
Â  Â  Â  addBtnMove=document.getElementById('add-btn-move'),
Â  Â  Â  popupElement=document.getElementById('popup'),
Â  Â  Â  buttonContainer=document.getElementById('buttonContainer'),
Â  Â  Â  settingsArea=document.getElementById('settingsArea');

function speak(text, targetElement){
Â  Â  if(!text||!('speechSynthesis'in window))return;
Â  Â  speechSynthesis.cancel();
Â  Â  let u=new SpeechSynthesisUtterance(text);
Â  Â  u.lang='vi-VN';
Â  Â  speechSynthesis.speak(u);
Â  Â  showPopup(text);Â 
}

function showPopup(text){
Â  Â  popupElement.textContent=text;
Â  Â  popupElement.style.display='block';
Â  Â  popupElement.style.opacity='1';

Â  Â  setTimeout(()=>{Â 
Â  Â  Â  Â  popupElement.style.opacity='0';Â 
Â  Â  Â  Â  setTimeout(()=>popupElement.style.display='none', 500)Â 
Â  Â  },3500)Â 
}

function getCards(){return document.querySelectorAll('.card input')}

// HÃ m nÃ y Ä‘áº£m báº£o currentIndex luÃ´n trá» Ä‘áº¿n má»™t vá»‹ trÃ­ há»£p lá»‡
function updateCurrentIndexAfterChange() {
Â  Â  const c = getCards();
Â  Â  currentIndex = Math.min(currentIndex, c.length - 1);
Â  Â  if (currentIndex < 0) currentIndex = 0;
}

// HÃ€M Sá»¬A Äá»”I: ThÃªm suggestion-box vÃ  sá»± kiá»‡n input/blur
function addButton(v=''){
Â  Â  let c=document.createElement('div');
Â  Â  c.className='card';
Â  Â  
    // INPUT Bá»” SUNG: ThÃªm sá»± kiá»‡n vÃ  táº¡o suggestion-box
Â  Â  let i=document.createElement('input');
Â  Â  i.value=v;
Â  Â  i.placeholder="Nháº­p vÄƒn báº£n...";
Â  Â  i.onchange=saveAll;
    
    let sBox = document.createElement('div'); // Há»™p gá»£i Ã½
    sBox.className = 'suggestion-box';

    // Gáº¯n sá»± kiá»‡n khi gÃµ
    i.addEventListener('input', (e) => showSuggestions(e.target, sBox));
    
    // áº¨n há»™p gá»£i Ã½ khi máº¥t focus (dÃ¹ng setTimeout Ä‘á»ƒ cho phÃ©p click vÃ o gá»£i Ã½)
    i.addEventListener('blur', () => {
        setTimeout(() => sBox.style.display = 'none', 150);
    });
    // Káº¾T THÃšC Sá»¬A Äá»”I INPUT
    
Â  Â  let p=document.createElement('button');
Â  Â  p.className='btn play-btn';
Â  Â  p.textContent='ğŸ”Š PhÃ¡t Ã¢m';
Â  Â  p.onclick=()=>speak(i.value.trim(), p);Â 
Â  Â  let d=document.createElement('button');
Â  Â  d.className='delete-btn';
Â  Â  d.textContent='âŒ';
Â  Â  d.onclick=()=>{
Â  Â  Â  Â  c.remove();
Â  Â  Â  Â  saveAll();
Â  Â  Â  Â  updateCurrentIndexAfterChange(); // Cáº­p nháº­t sau khi xÃ³a
Â  Â  };
    // ÄÃ­nh kÃ¨m suggestion box vÃ o card
Â  Â  c.append(i, sBox, p, d); 
Â  Â  document.getElementById('buttonContainer').appendChild(c);
Â  Â  saveAll();
Â  Â  // Äáº·t currentIndex vÃ o tháº» má»›i (tháº» cuá»‘i cÃ¹ng)
Â  Â  currentIndex = getCards().length - 1;Â 
}

function saveAll(){localStorage.setItem('voiceButtons',JSON.stringify([...document.querySelectorAll('.card input')].map(i=>i.value.trim())))}
function loadButtons(){let s=JSON.parse(localStorage.getItem('voiceButtons')||"[]");(s.length?s:defaults).forEach(t=>addButton(t));currentIndex=0; cleanupEmptyCards();}
function resetDefaults(){if(confirm("Äáº·t láº¡i máº·c Ä‘á»‹nh?")){localStorage.removeItem('voiceButtons');document.getElementById('buttonContainer').innerHTML='';loadButtons();currentIndex=0;}}

function cleanupEmptyCards(){
Â  Â  let c=document.querySelectorAll('.card'),save=false;
Â  Â  for(let i=c.length-1;i>=0;i--){
Â  Â  Â  Â  let inp=c[i].querySelector('input');
Â  Â  Â  Â  // Chá»‰ xÃ³a tháº» náº¿u nÃ³ hoÃ n toÃ n trá»‘ng
Â  Â  Â  Â  if(!inp||inp.value.trim()===''){
Â  Â  Â  Â  Â  Â  c[i].remove();
Â  Â  Â  Â  Â  Â  save=true;
Â  Â  Â  Â  }
Â  Â  }
Â  Â  if(save){
Â  Â  Â  Â  saveAll();
Â  Â  Â  Â  updateCurrentIndexAfterChange();
Â  Â  }
}

function moveSpeak(dir){
Â  Â  // Bá» cleanupEmptyCards() Ä‘á»ƒ Ä‘áº£m báº£o Ä‘iá»u hÆ°á»›ng á»•n Ä‘á»‹nh
Â  Â  const c=getCards();
Â  Â  if(c.length===0)return;
Â  Â Â 
Â  Â  if(dir===0){
Â  Â  Â  Â  // PhÃ¡t láº¡i cÃ¢u hiá»‡n táº¡i, kiá»ƒm tra trá»‘ng
Â  Â  Â  Â  const text = c[currentIndex].value.trim();
Â  Â  Â  Â  if (text) {
Â  Â  Â  Â  Â  Â  speak(text);
Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Â  showPopup("CÃ¢u trá»‘ng! Vui lÃ²ng sá»­a hoáº·c xÃ³a.");
Â  Â  Â  Â  }
Â  Â  } else {
Â  Â  Â  Â  // Di chuyá»ƒn cÃ¢u trÆ°á»›c/sau
Â  Â  Â  Â  currentIndex=(currentIndex+dir+c.length)%c.length;
Â  Â  Â  Â Â 
Â  Â  Â  Â  // VÃ²ng láº·p tÃ¬m cÃ¢u khÃ´ng trá»‘ng (Ä‘á»ƒ trÃ¡nh láº·p vÃ´ táº­n náº¿u Táº¤T Cáº¢ trá»‘ng)
Â  Â  Â  Â  let count = 0;
Â  Â  Â  Â  while(c[currentIndex].value.trim() === '' && count < c.length) {
Â  Â  Â  Â  Â  Â  currentIndex=(currentIndex+dir+c.length)%c.length;
Â  Â  Â  Â  Â  Â  count++;
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  // Náº¿u tÃ¬m tháº¥y cÃ¢u Ä‘á»ƒ Ä‘á»c
Â  Â  Â  Â  const text = c[currentIndex].value.trim();
Â  Â  Â  Â  if (text) {
Â  Â  Â  Â  Â  Â  speak(text);
Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Â  Â // Chá»‰ xáº£y ra náº¿u táº¥t cáº£ cÃ¡c cÃ¢u Ä‘á»u trá»‘ng
Â  Â  Â  Â  Â  Â  showPopup("KhÃ´ng cÃ³ cÃ¢u nÃ o Ä‘á»ƒ Ä‘á»c.");
Â  Â  Â  Â  }
Â  Â  }
}

function toggleLock(lock){
Â  Â  const u=document.getElementById('unlock-btn');
Â  Â  // Khi thoÃ¡t khá»i cháº¿ Ä‘á»™ khÃ³a, dá»n dáº¹p tháº» trá»‘ng
Â  Â  if (!lock) {
Â  Â  Â  Â  cleanupEmptyCards();
Â  Â  }
Â  Â Â 
Â  Â  if(lock){
Â  Â  Â  Â  buttonContainer.style.display='none';
Â  Â  Â  Â  addBtnMove.style.display='none';
Â  Â  Â  Â  settingsArea.style.display='none';
Â  Â  Â  Â Â 
Â  Â  Â  Â  controlArea.classList.add('locked');
Â  Â  Â  Â  document.body.classList.add('locked');
Â  Â  Â  Â  document.getElementById('mainTitle').classList.add('locked-h1');
Â  Â  Â  Â  u.style.display='flex';
Â  Â  } else {
Â  Â  Â  Â  buttonContainer.style.display='grid';
Â  Â  Â  Â  addBtnMove.style.display='block';
Â  Â  Â  Â  settingsArea.style.display='block';
Â  Â  Â  Â Â 
Â  Â  Â  Â  controlArea.classList.remove('locked');
Â  Â  Â  Â  document.body.classList.remove('locked');
Â  Â  Â  Â  document.getElementById('mainTitle').classList.remove('locked-h1');
Â  Â  Â  Â  u.style.display='none';
Â  Â  }
}

// Gáº¯n sá»± kiá»‡n cho cÃ¡c nÃºt Ä‘iá»u hÆ°á»›ng
document.querySelectorAll('.control-btn').forEach(button => {
Â  Â  // Giá»¯ cáº£ click vÃ  touchend Ä‘á»ƒ tá»‘i Æ°u pháº£n há»“i trÃªn di Ä‘á»™ng
Â  Â  ['click', 'touchend'].forEach(event => {
Â  Â  Â  Â  button.addEventListener(event, function(e) {
Â  Â  Â  Â  Â  Â  // NgÄƒn cháº·n sá»± kiá»‡n cháº¡m kÃ­ch hoáº¡t click hai láº§n
Â  Â  Â  Â  Â  Â  e.preventDefault();Â 
Â  Â  Â  Â  Â  Â  // DÃ¹ng currentTarget Ä‘á»ƒ láº¥y data-direction cá»§a nÃºt
Â  Â  Â  Â  Â  Â  moveSpeak(parseInt(e.currentTarget.dataset.direction));Â 
Â  Â  Â  Â  }, { passive: false });
Â  Â  });
});

window.addEventListener('beforeinstallprompt',e=>{Â 
Â  Â  e.preventDefault();Â 
Â  Â  deferredPrompt=e;Â 
Â  Â  if (installState === 'before_install') {
Â  Â  Â  Â  installButton.style.display='flex';
Â  Â  Â  Â  installButton.onclick=installApp;
Â  Â  }
});

function installApp(){
Â  Â  if(deferredPrompt){
Â  Â  Â  Â  deferredPrompt.prompt();
Â  Â  Â  Â  deferredPrompt.userChoice.then((choiceResult)=>{
Â  Â  Â  Â  Â  Â  if (choiceResult.outcome === 'accepted') {
Â  Â  Â  Â  Â  Â  Â  Â  installState = 'installed';
Â  Â  Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Â  Â  Â  installState = 'rejected';
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  deferredPrompt=null;
Â  Â  Â  Â  Â  Â  installButton.style.display='none';
Â  Â  Â  Â  });
Â  Â  }
}

window.addEventListener('appinstalled',()=>{Â 
Â  Â  installState = 'installed';Â 
Â  Â  installButton.style.display='none';Â 
});

if (installState === 'before_install') {Â 
Â  Â  installButton.style.display='none';Â 
}

function warmUpTTS(){
Â  Â  if(!('speechSynthesis'in window))return;
Â  Â  let u=new SpeechSynthesisUtterance(" ");
Â  Â  u.lang='vi-VN';
Â  Â  u.volume=0;
Â  Â  u.rate=10;
Â  Â  speechSynthesis.speak(u);
Â  Â  setTimeout(()=>speechSynthesis.cancel(),500)
}
// Cáº¬P NHáº¬T: KhÃ´ng cáº§n gá»i loadSuggestions() ná»¯a
window.onload=()=>{loadButtons();warmUpTTS();}
</script>

</body>
</html>
