<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>M√°y h·ªó tr·ª£ gi·ªçng n√≥i</title>
<style>
body { font-family:'Segoe UI', sans-serif; background:#e3f2fd; margin:0; padding:0; text-align:center; }
h1 {margin:20px 0;}
.container { display:grid; grid-template-columns:repeat(auto-fit, minmax(240px,1fr)); gap:20px; margin-bottom:20px; }
.card { background:#fff; padding:18px; border-radius:12px; box-shadow:0 3px 8px rgba(0,0,0,0.15); display:flex; flex-direction:column; gap:10px; position:relative; }
input {padding:10px; font-size:16px; border-radius:8px; border:1px solid #ccc; width:100%; }
.btn {padding:12px; border:none; border-radius:8px; color:white; font-size:16px; cursor:pointer; transition:0.3s;}
.play-btn {background:linear-gradient(45deg,#4CAF50,#43A047);}
.play-btn:hover {transform:scale(1.05);}
.delete-btn {position:absolute; top:6px; right:8px; border:none; background:transparent; color:#e53935; font-size:18px; cursor:pointer;}
.add-btn, .reset-btn {background:linear-gradient(45deg,#2196F3,#1976D2); width:200px; margin:8px auto; display:block;}
.add-btn:hover, .reset-btn:hover {transform:scale(1.05);}
.control-container {display:flex; flex-direction:column; align-items:center; justify-content:center; gap:10px; height:300px; position:fixed; top:50%; left:50%; transform:translate(-50%,-50%); z-index:100;}
.control-btn {width:80px; height:80px; border-radius:50%; background:#ff9800; color:white; font-size:28px; border:none; cursor:pointer; margin:10px 0; transition:0.3s;}
.control-btn:hover {transform:scale(1.1);}
#unlock-btn {position:absolute; top:-50px; right:0; background:#f44336; width:100px;}
#popup {position:absolute; bottom:150px; left:50%; transform:translateX(-50%); background:rgba(0,0,0,0.7); color:white; padding:15px 20px; border-radius:12px; font-size:18px; display:none; z-index:101; max-width:80%; text-align:center;}
</style>
</head>
<body>
<h1>M√°y h·ªó tr·ª£ gi·ªçng n√≥i</h1>

<div class="container" id="buttonContainer"></div>

<div class="control-container" id="controlArea">
  <button class="control-btn" onclick="prevSpeak()">‚ñ≤</button>
  <button class="control-btn" onclick="currentSpeak()">‚óè</button>
  <button class="control-btn" onclick="nextSpeak()">‚ñº</button>
  <button class="btn" id="unlock-btn" onclick="toggleLock(false)" style="display:none;">M·ªü kh√≥a</button>
</div>

<div id="settingsArea" style="margin-top:20px;">
  <button class="btn add-btn" onclick="addButton()">‚ûï Th√™m N√∫t</button>
  <button class="btn reset-btn" onclick="resetDefaults()">‚ôªÔ∏è Reset m·∫∑c ƒë·ªãnh</button>
  <button class="btn" style="background:#ff9800;margin-top:10px;" onclick="toggleLock(true)">Kh√≥a giao di·ªán</button>
</div>

<div id="popup"></div>

<script>
const defaults = [
  "T√¥i mu·ªën ƒÉn c∆°m",
  "T√¥i mu·ªën u·ªëng n∆∞·ªõc",
  "T√¥i mu·ªën ƒëi v·ªá sinh",
  "T√¥i mu·ªën ƒëi ng·ªß"
];
let currentIndex = 0;

// --- Qu·∫£n l√Ω n√∫t ---
function speak(text){
  if(!text) return;
  const u=new SpeechSynthesisUtterance(text);
  u.lang='vi-VN';
  speechSynthesis.speak(u);
  showPopup(text);
}

function addButton(value=''){
  const card=document.createElement('div'); card.className='card';
  const input=document.createElement('input'); input.value=value; input.placeholder="Nh·∫≠p vƒÉn b·∫£n..."; input.onchange=saveAll;
  const play=document.createElement('button'); play.className='btn play-btn'; play.textContent='üîä Ph√°t √¢m'; play.onclick=()=>speak(input.value.trim());
  const del=document.createElement('button'); del.className='delete-btn'; del.textContent='‚ùå'; del.onclick=()=>{card.remove(); saveAll(); if(currentIndex>=getCards().length) currentIndex=getCards().length-1;};
  card.append(input,play,del);
  document.getElementById('buttonContainer').appendChild(card);
  saveAll();
}

function saveAll(){
  const texts=[...document.querySelectorAll('.card input')].map(i=>i.value.trim());
  localStorage.setItem('voiceButtons',JSON.stringify(texts));
}

function loadButtons(){
  const saved=JSON.parse(localStorage.getItem('voiceButtons')||"[]");
  const list=saved.length? saved:defaults;
  list.forEach(text=>addButton(text));
}

function resetDefaults(){
  if(confirm("B·∫°n c√≥ mu·ªën ƒë·∫∑t l·∫°i v·ªÅ m·∫∑c ƒë·ªãnh?")){
    localStorage.removeItem('voiceButtons');
    document.getElementById('buttonContainer').innerHTML='';
    loadButtons();
    currentIndex=0;
  }
}

function getCards(){ return document.querySelectorAll('.card input'); }

// --- 3 n√∫t ƒëi·ªÅu khi·ªÉn ---
function prevSpeak(){
  const cards=getCards(); if(cards.length===0) return;
  currentIndex=(currentIndex-1+cards.length)%cards.length;
  speak(cards[currentIndex].value.trim());
}
function nextSpeak(){
  const cards=getCards(); if(cards.length===0) return;
  currentIndex=(currentIndex+1)%cards.length;
  speak(cards[currentIndex].value.trim());
}
function currentSpeak(){
  const cards=getCards(); if(cards.length===0) return;
  speak(cards[currentIndex].value.trim());
}

// --- Popup ---
function showPopup(text){
  const popup=document.getElementById('popup');
  popup.textContent=text;
  popup.style.display='block';
  popup.style.opacity='1';
  setTimeout(()=>{ popup.style.opacity='0'; setTimeout(()=>popup.style.display='none',500); },2000);
}

// --- Kh√≥a / M·ªü kh√≥a ---
function toggleLock(lock){
  const settings=document.getElementById('settingsArea');
  const container=document.getElementById('buttonContainer');
  const unlockBtn=document.getElementById('unlock-btn');
  if(lock){
    settings.style.display='none';
    container.style.display='none';
    unlockBtn.style.display='block';
  } else {
    settings.style.display='block';
    container.style.display='grid';
    unlockBtn.style.display='none';
  }
}

window.onload=loadButtons;
</script>
</body>
</html>
