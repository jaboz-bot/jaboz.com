<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>B·∫£ng ƒêi·ªÅu Khi·ªÉn</title>
    <link rel="manifest" href="dashboard.json">
    <meta name="theme-color" content="#1976D2">
    <style>
        body {
            font-family: 'Segoe UI', sans-serif;
            background: #e3f2fd;
            margin: 0;
            padding: 50px 10px;
            text-align: center;
            /* Flex container cho to√†n b·ªô n·ªôi dung */
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh; /* ƒê·∫£m b·∫£o body chi·∫øm h·∫øt chi·ªÅu cao */
            justify-content: space-between; /* ƒê·∫©y c√†i ƒë·∫∑t xu·ªëng d∆∞·ªõi c√πng */
        }
        h1 {
            color: #1976D2;
            margin-bottom: 40px;
        }
        .main-container {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 20px;
            max-width: 800px;
            width: 100%;
            /* TƒÉng kho·∫£ng c√°ch d∆∞·ªõi c√πng ƒë·ªÉ t√°ch bi·ªát kh·ªèi n√∫t c√†i ƒë·∫∑t */
            margin-bottom: 50px; 
        }
        .app-link {
            text-decoration: none;
            color: white;
            padding: 30px 40px;
            border-radius: 12px;
            font-size: 20px;
            font-weight: bold;
            width: 250px;
            text-align: center;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
            transition: transform 0.2s, box-shadow 0.2s;
        }
        .app-link:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.3);
        }
        .voice-link {
            background: linear-gradient(45deg, #2196F3, #1976D2); /* Xanh d∆∞∆°ng */
        }
        .game-link {
            background: linear-gradient(45deg, #4CAF50, #388E3C); /* Xanh l√° */
        }
        .movie-link {
            background: linear-gradient(45deg, #FF9800, #F57C00); /* Cam */
        }

        /* V√πng ch·ª©a m·ªõi cho n√∫t C√†i ƒê·∫∑t */
        .settings-area {
            width: 100%;
            text-align: center;
            padding-bottom: 30px; /* Kho·∫£ng c√°ch t·ª´ ƒë√°y trang */
            margin-top: auto; /* ƒê·∫©y n√≥ xu·ªëng d∆∞·ªõi c√πng */
        }

        /* CSS M·ªõi cho n√∫t C√†i ƒê·∫∑t ·ª®ng D·ª•ng (nh·ªè h∆°n) */
        .settings-link {
            /* M√†u t√≠m */
            background: linear-gradient(45deg, #9C27B0, #7B1FA2); 
            
            /* ƒêi·ªÅu ch·ªânh k√≠ch th∆∞·ªõc nh·ªè h∆°n */
            padding: 15px 30px; 
            font-size: 16px; 
            width: auto; /* Cho ph√©p n√≥ co l·∫°i theo n·ªôi dung */
            display: inline-block; /* Quan tr·ªçng ƒë·ªÉ √°p d·ª•ng width/padding */
            border-radius: 8px; /* Bo tr√≤n nh·ªè h∆°n */
        }
        .settings-link:hover {
             transform: translateY(-2px); /* Hi·ªáu ·ª©ng nh·ªè h∆°n */
             box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
        }
    </style>
</head>
<body>
    
    <div style="width: 100%; display: flex; flex-direction: column; align-items: center;">
        <h1>Ch·ªçn ·ª®ng D·ª•ng</h1>
        <div class="main-container">
            
            <a href="tools/may-ho-tro-giong-noi/may-voice.html" class="app-link voice-link">
                üí¨ M√°y H·ªó Tr·ª£ Gi·ªçng N√≥i
            </a>
            
            <a href="choi-game/menu-game.html" class="app-link game-link">
                üéÆ Ch∆°i Game             
            </a>
            
            <a href="tv/tv.html" class="app-link movie-link">
                üé¨ TV Tr·ª±c Tuy·∫øn
            </a>
            
        </div>
    </div>

<div class="settings-area">
        <!-- N√∫t C√†i ƒë·∫∑t PWA. M·∫∑c ƒë·ªãnh ·∫©n, ch·ªâ hi·ªÉn th·ªã khi beforeinstallprompt ƒë∆∞·ª£c k√≠ch ho·∫°t. -->
        <button id="installButton" class="settings-link" style="display: none;">
            üì≤ C√†i ƒë·∫∑t app
        </button>
    </div>

    <script>
        // Bi·∫øn n√†y s·∫Ω l∆∞u tr·ªØ s·ª± ki·ªán c√†i ƒë·∫∑t PWA c·ªßa tr√¨nh duy·ªát
        let deferredPrompt;
        const installButton = document.getElementById('installButton');

        // H√†m ki·ªÉm tra v√† ·∫©n n√∫t n·∫øu ƒëang ·ªü ch·∫ø ƒë·ªô ƒë·ªôc l·∫≠p (standalone)
        function hideInstallButtonIfStandalone() {
            if (window.matchMedia('(display-mode: standalone)').matches) {
                installButton.style.display = 'none';
                console.log('App is running in standalone mode, Install button hidden.');
                return true;
            }
            return false;
        }

        // 3. ·∫®n n√∫t n·∫øu ·ª©ng d·ª•ng ƒë√£ ƒë∆∞·ª£c c√†i ƒë·∫∑t v√† ƒëang ch·∫°y ·ªü ch·∫ø ƒë·ªô standalone
        hideInstallButtonIfStandalone();

        // H√†m x·ª≠ l√Ω khi ng∆∞·ªùi d√πng nh·∫•n n√∫t c√†i ƒë·∫∑t
        function installApp() {
            if (deferredPrompt) {
                // T·∫°m th·ªùi ·∫©n n√∫t khi h·ªôp tho·∫°i c√†i ƒë·∫∑t ƒë∆∞·ª£c hi·ªÉn th·ªã
                installButton.style.display = 'none';
                
                // Hi·ªÉn th·ªã h·ªôp tho·∫°i c√†i ƒë·∫∑t c·ªßa tr√¨nh duy·ªát
                deferredPrompt.prompt();
                
                // Ch·ªù ƒë·ª£i ng∆∞·ªùi d√πng ch·ªçn
                deferredPrompt.userChoice.then((choiceResult) => {
                    console.log('User choice:', choiceResult.outcome);
                    
                    if (choiceResult.outcome === 'accepted') {
                        // Ng∆∞·ªùi d√πng ch·∫•p nh·∫≠n c√†i ƒë·∫∑t: ·∫®n n√∫t vƒ©nh vi·ªÖn
                        console.log('App installed successfully');
                        installButton.style.display = 'none';
                    } else {
                        // Ng∆∞·ªùi d√πng h·ªßy/b·ªè qua c√†i ƒë·∫∑t: Hi·ªán l·∫°i n√∫t ƒë·ªÉ h·ªç th·ª≠ l·∫°i sau
                        console.log('Installation cancelled, showing button again.');
                        installButton.style.display = 'inline-block';
                    }
                    
                    // Sau khi x·ª≠ l√Ω, x√≥a bi·∫øn ƒë√£ l∆∞u tr·ªØ s·ª± ki·ªán
                    deferredPrompt = null;
                });
            }
        }


        // 1. L·∫Øng nghe s·ª± ki·ªán tr∆∞·ªõc khi c√†i ƒë·∫∑t
        window.addEventListener('beforeinstallprompt', (e) => {
            // NgƒÉn ch·∫∑n tr√¨nh duy·ªát t·ª± ƒë·ªông hi·ªÉn th·ªã h·ªôp tho·∫°i (ƒë·ªÉ ch√∫ng ta c√≥ th·ªÉ ki·ªÉm so√°t n√≥)
            e.preventDefault();
            // L∆∞u tr·ªØ s·ª± ki·ªán ƒë·ªÉ k√≠ch ho·∫°t n√≥ sau
            deferredPrompt = e;
            
            // Ch·ªâ hi·ªÉn th·ªã n√∫t n·∫øu ch∆∞a ƒë∆∞·ª£c c√†i ƒë·∫∑t
            if (!hideInstallButtonIfStandalone()) {
                installButton.style.display = 'inline-block';
                console.log('beforeinstallprompt fired. Install button shown.');
                // G·∫Øn h√†m x·ª≠ l√Ω v√†o s·ª± ki·ªán click c·ªßa n√∫t
                installButton.addEventListener('click', installApp, { once: true });
            }
        });


        // 4. ·∫®n n√∫t n·∫øu ·ª©ng d·ª•ng ƒë∆∞·ª£c c√†i ƒë·∫∑t th√†nh c√¥ng t·ª´ h·ªôp tho·∫°i tr√¨nh duy·ªát
        window.addEventListener('appinstalled', (e) => {
            installButton.style.display = 'none';
            console.log('App successfully installed, Install button hidden.');
        });
    </script>
</body>
</html>
